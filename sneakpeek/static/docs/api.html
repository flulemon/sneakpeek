<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API &mdash; Sneakpeek 0.1.4 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Adding your own plugin" href="plugins/new_plugin.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Sneakpeek
          </a>
              <div class="version">
                0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick start</a></li>
<li class="toctree-l1"><a class="reference internal" href="local_debugging.html">Local scraper handler debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment.html">Deployment options</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins/index.html">Plugins</a><ul>
<li class="toctree-l2"><a class="reference internal" href="plugins/rate_limiter_plugin.html">Rate limiter</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins/robots_txt_plugin.html">Robots.txt</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins/user_agent_injecter_plugin.html">User Agent injector</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins/proxy_plugin.html">Proxy plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins/requests_logging_plugin.html">Requests logging middleware</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugins/new_plugin.html">Adding your own plugin</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Sneakpeek</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>API</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-sneakpeek.server">
<span id="api"></span><h1>API<a class="headerlink" href="#module-sneakpeek.server" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.server.SneakpeekServer">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.server.</span></span><span class="sig-name descname"><span class="pre">SneakpeekServer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">worker</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.worker.WorkerABC" title="sneakpeek.worker.WorkerABC"><span class="pre">sneakpeek.worker.WorkerABC</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.scheduler.SchedulerABC" title="sneakpeek.scheduler.SchedulerABC"><span class="pre">sneakpeek.scheduler.SchedulerABC</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">fastapi_jsonrpc.API</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_port</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">8080</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expose_metrics</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_port</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">9090</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.server.SneakpeekServer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Sneakpeek server. It can run multiple services at once:</p>
<ul class="simple">
<li><p>API - allows interactions with scrapers storage and scrapers via JsonRPC or UI</p></li>
<li><p>Worker - executes scheduled scrapers</p></li>
<li><p>Scheduler - automatically schedules scrapers that are stored in the storage</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>worker</strong> (<a class="reference internal" href="#sneakpeek.worker.WorkerABC" title="sneakpeek.worker.WorkerABC"><em>WorkerABC</em></a><em> | </em><em>None</em><em>, </em><em>optional</em>) – Worker that consumes scraper jobs queue. Defaults to None.</p></li>
<li><p><strong>scheduler</strong> (<a class="reference internal" href="#sneakpeek.scheduler.SchedulerABC" title="sneakpeek.scheduler.SchedulerABC"><em>SchedulerABC</em></a><em> | </em><em>None</em><em>, </em><em>optional</em>) – Scrapers scheduler. Defaults to None.</p></li>
<li><p><strong>api</strong> (<em>jsonrpc.API</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – API to interact with the system. Defaults to None.</p></li>
<li><p><strong>api_port</strong> (<em>int</em><em>, </em><em>optional</em>) – Port which is used for API and UI. Defaults to 8080.</p></li>
<li><p><strong>expose_metrics</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to expose metrics (prometheus format). Defaults to True.</p></li>
<li><p><strong>metrics_port</strong> (<em>int</em><em>, </em><em>optional</em>) – Port which is used to expose metric. Defaults to 9090.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.server.SneakpeekServer.create">
<em class="property"><span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">create</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">handlers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.scraper_handler.ScraperHandler" title="sneakpeek.scraper_handler.ScraperHandler"><span class="pre">sneakpeek.scraper_handler.ScraperHandler</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scrapers_storage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.storage.base.ScrapersStorage" title="sneakpeek.lib.storage.base.ScrapersStorage"><span class="pre">sneakpeek.lib.storage.base.ScrapersStorage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs_storage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.storage.base.ScraperJobsStorage" title="sneakpeek.lib.storage.base.ScraperJobsStorage"><span class="pre">sneakpeek.lib.storage.base.ScraperJobsStorage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lease_storage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.storage.base.LeaseStorage" title="sneakpeek.lib.storage.base.LeaseStorage"><span class="pre">sneakpeek.lib.storage.base.LeaseStorage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_api</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_worker</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_scheduler</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expose_metrics</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">worker_max_concurrency</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">api_port</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">8080</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler_storage_poll_delay</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">datetime.timedelta</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">datetime.timedelta(seconds=5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler_lease_duration</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">datetime.timedelta</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">datetime.timedelta(seconds=60)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plugins</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.scraper_context.BeforeRequestPlugin" title="sneakpeek.scraper_context.BeforeRequestPlugin"><span class="pre">sneakpeek.scraper_context.BeforeRequestPlugin</span></a> <span class="p"><span class="pre">|</span></span> <a class="reference internal" href="#sneakpeek.scraper_context.AfterResponsePlugin" title="sneakpeek.scraper_context.AfterResponsePlugin"><span class="pre">sneakpeek.scraper_context.AfterResponsePlugin</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_port</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">9090</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.server.SneakpeekServer.create" title="Permalink to this definition"></a></dt>
<dd><p>Create Sneakpeek server using default API, worker and scheduler implementations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handlers</strong> (<em>list</em><em>[</em><a class="reference internal" href="#sneakpeek.scraper_handler.ScraperHandler" title="sneakpeek.scraper_handler.ScraperHandler"><em>ScraperHandler</em></a><em>]</em>) – List of handlers that implement scraper logic</p></li>
<li><p><strong>scrapers_storage</strong> (<a class="reference internal" href="#sneakpeek.lib.storage.base.ScrapersStorage" title="sneakpeek.lib.storage.base.ScrapersStorage"><em>ScrapersStorage</em></a>) – Scrapers storage</p></li>
<li><p><strong>jobs_storage</strong> (<a class="reference internal" href="#sneakpeek.lib.storage.base.ScraperJobsStorage" title="sneakpeek.lib.storage.base.ScraperJobsStorage"><em>ScraperJobsStorage</em></a>) – Jobs storage</p></li>
<li><p><strong>lease_storage</strong> (<a class="reference internal" href="#sneakpeek.lib.storage.base.LeaseStorage" title="sneakpeek.lib.storage.base.LeaseStorage"><em>LeaseStorage</em></a>) – Lease storage</p></li>
<li><p><strong>run_api</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to run API service. Defaults to True.</p></li>
<li><p><strong>run_worker</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to run worker service. Defaults to True.</p></li>
<li><p><strong>run_scheduler</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to run scheduler service. Defaults to True.</p></li>
<li><p><strong>expose_metrics</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to expose metrics (prometheus format). Defaults to True.</p></li>
<li><p><strong>worker_max_concurrency</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of concurrently executed scrapers. Defaults to 50.</p></li>
<li><p><strong>api_port</strong> (<em>int</em><em>, </em><em>optional</em>) – Port which is used for API and UI. Defaults to 8080.</p></li>
<li><p><strong>scheduler_storage_poll_delay</strong> (<em>timedelta</em><em>, </em><em>optional</em>) – How much scheduler wait before polling storage for scrapers updates. Defaults to 5 seconds.</p></li>
<li><p><strong>scheduler_lease_duration</strong> (<em>timedelta</em><em>, </em><em>optional</em>) – How long scheduler lease lasts. Lease is required for scheduler to be able to create new scraper jobs. This is needed so at any point of time there’s only one active scheduler instance. Defaults to 1 minute.</p></li>
<li><p><strong>plugins</strong> (<em>list</em><em>[</em><em>Plugin</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – List of plugins that will be used by scraper runner. Can be omitted if run_worker is False. Defaults to None.</p></li>
<li><p><strong>metrics_port</strong> (<em>int</em><em>, </em><em>optional</em>) – Port which is used to expose metric. Defaults to 9090.</p></li>
<li><p><strong>with_api</strong> (<em>bool</em>) – </p></li>
<li><p><strong>with_worker</strong> (<em>bool</em>) – </p></li>
<li><p><strong>with_scheduler</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.server.SneakpeekServer.serve">
<span class="sig-name descname"><span class="pre">serve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loop</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">asyncio.events.AbstractEventLoop</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blocking</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.server.SneakpeekServer.serve" title="Permalink to this definition"></a></dt>
<dd><p>Start Sneakpeek server</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loop</strong> (<em>asyncio.AbstractEventLoop</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – AsyncIO loop to use. In case it’s None result of <cite>asyncio.get_event_loop()</cite> will be used. Defaults to None.</p></li>
<li><p><strong>blocking</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to block thread while server is running. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.server.SneakpeekServer.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loop</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">asyncio.events.AbstractEventLoop</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.server.SneakpeekServer.stop" title="Permalink to this definition"></a></dt>
<dd><p>Stop Sneakpeek server</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>loop</strong> (<em>asyncio.AbstractEventLoop</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – AsyncIO loop to use. In case it’s None result of <cite>asyncio.get_event_loop()</cite> will be used. Defaults to None.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-sneakpeek.scraper_config"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.scraper_config.ScraperConfig">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.scraper_config.</span></span><span class="sig-name descname"><span class="pre">ScraperConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plugins</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.scraper_config.ScraperConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<p>Scraper configuration</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>typing.Any</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>plugins</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>typing.Any</em><em>] </em><em>| </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.scraper_config.ScraperConfig.params">
<span class="sig-name descname"><span class="pre">params</span></span><a class="headerlink" href="#sneakpeek.scraper_config.ScraperConfig.params" title="Permalink to this definition"></a></dt>
<dd><p>Scraper configuration that is passed to the handler. Defaults to None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict[str, Any] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.scraper_config.ScraperConfig.plugins">
<span class="sig-name descname"><span class="pre">plugins</span></span><a class="headerlink" href="#sneakpeek.scraper_config.ScraperConfig.plugins" title="Permalink to this definition"></a></dt>
<dd><p>Plugins configuration that defines which plugins to use (besides global ones). Takes precedence over global plugin configuration. Defaults to None.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict[str, Any] | None</p>
</dd>
</dl>
</dd></dl>

<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises ValidationError if the input data cannot be parsed to form a valid model.</p>
</dd></dl>

<span class="target" id="module-sneakpeek.scraper_context"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.AfterResponsePlugin">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.scraper_context.</span></span><span class="sig-name descname"><span class="pre">AfterResponsePlugin</span></span><a class="headerlink" href="#sneakpeek.scraper_context.AfterResponsePlugin" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Abstract class for the plugin which is called after each request</p>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.AfterResponsePlugin.after_response">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">after_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><span class="pre">sneakpeek.scraper_context.Request</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">response</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">aiohttp.client_reqrep.ClientResponse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">aiohttp.client_reqrep.ClientResponse</span></span></span><a class="headerlink" href="#sneakpeek.scraper_context.AfterResponsePlugin.after_response" title="Permalink to this definition"></a></dt>
<dd><p>Function that is called on each (HTTP) response before its result returned to the caller.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> (<a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><em>Request</em></a>) – Request metadata</p></li>
<li><p><strong>response</strong> (<em>aiohttp.ClientResponse</em>) – HTTP Response</p></li>
<li><p><strong>config</strong> (<em>Any</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Plugin configuration. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTP Response</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>aiohttp.ClientResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.AfterResponsePlugin.name">
<em class="property"><span class="pre">abstract</span> <span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#sneakpeek.scraper_context.AfterResponsePlugin.name" title="Permalink to this definition"></a></dt>
<dd><p>Name of the plugin</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.BeforeRequestPlugin">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.scraper_context.</span></span><span class="sig-name descname"><span class="pre">BeforeRequestPlugin</span></span><a class="headerlink" href="#sneakpeek.scraper_context.BeforeRequestPlugin" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Abstract class for the plugin which is called before each request (like Middleware)</p>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.BeforeRequestPlugin.before_request">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">before_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><span class="pre">sneakpeek.scraper_context.Request</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><span class="pre">sneakpeek.scraper_context.Request</span></a></span></span><a class="headerlink" href="#sneakpeek.scraper_context.BeforeRequestPlugin.before_request" title="Permalink to this definition"></a></dt>
<dd><p>Function that is called on each (HTTP) request before its dispatched.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> (<a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><em>Request</em></a>) – Request metadata</p></li>
<li><p><strong>config</strong> (<em>Any</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Plugin configuration. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Request metadata</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request">Request</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.BeforeRequestPlugin.name">
<em class="property"><span class="pre">abstract</span> <span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#sneakpeek.scraper_context.BeforeRequestPlugin.name" title="Permalink to this definition"></a></dt>
<dd><p>Name of the plugin</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.HttpMethod">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.scraper_context.</span></span><span class="sig-name descname"><span class="pre">HttpMethod</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.scraper_context.HttpMethod" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>HTTP method</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.Request">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.scraper_context.</span></span><span class="sig-name descname"><span class="pre">Request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.scraper_context.HttpMethod" title="sneakpeek.scraper_context.HttpMethod"><span class="pre">sneakpeek.scraper_context.HttpMethod</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">typing.Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.scraper_context.Request" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>HTTP Request metadata</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method</strong> (<a class="reference internal" href="#sneakpeek.scraper_context.HttpMethod" title="sneakpeek.scraper_context.HttpMethod"><em>sneakpeek.scraper_context.HttpMethod</em></a>) – </p></li>
<li><p><strong>url</strong> (<em>str</em>) – </p></li>
<li><p><strong>headers</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>] </em><em>| </em><em>None</em>) – </p></li>
<li><p><strong>kwargs</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>typing.Any</em><em>] </em><em>| </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.ScraperContext">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.scraper_context.</span></span><span class="sig-name descname"><span class="pre">ScraperContext</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.scraper_config.ScraperConfig" title="sneakpeek.scraper_config.ScraperConfig"><span class="pre">sneakpeek.scraper_config.ScraperConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">plugins</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.scraper_context.BeforeRequestPlugin" title="sneakpeek.scraper_context.BeforeRequestPlugin"><span class="pre">sneakpeek.scraper_context.BeforeRequestPlugin</span></a> <span class="p"><span class="pre">|</span></span> <a class="reference internal" href="#sneakpeek.scraper_context.AfterResponsePlugin" title="sneakpeek.scraper_context.AfterResponsePlugin"><span class="pre">sneakpeek.scraper_context.AfterResponsePlugin</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ping_session_func</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.scraper_context.ScraperContext" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Scraper context - helper class that implements basic HTTP client which logic can be extended by
plugins that can preprocess request (e.g. Rate Limiter) and postprocess response (e.g. Response logger).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#sneakpeek.scraper_config.ScraperConfig" title="sneakpeek.scraper_config.ScraperConfig"><em>ScraperConfig</em></a>) – Scraper configuration</p></li>
<li><p><strong>plugins</strong> (<em>list</em><em>[</em><a class="reference internal" href="#sneakpeek.scraper_context.BeforeRequestPlugin" title="sneakpeek.scraper_context.BeforeRequestPlugin"><em>BeforeRequestPlugin</em></a><em> | </em><a class="reference internal" href="#sneakpeek.scraper_context.AfterResponsePlugin" title="sneakpeek.scraper_context.AfterResponsePlugin"><em>AfterResponsePlugin</em></a><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – List of available plugins. Defaults to None.</p></li>
<li><p><strong>ping_session_func</strong> (<em>Callable</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Function that pings scraper job. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.ScraperContext.delete">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">aiohttp.client_reqrep.ClientResponse</span></span></span><a class="headerlink" href="#sneakpeek.scraper_context.ScraperContext.delete" title="Permalink to this definition"></a></dt>
<dd><p>Make DELETE request to the given URL</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – URL to send DELETE request to</p></li>
<li><p><strong>headers</strong> (<em>HttpHeaders</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – HTTP headers. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> – See aiohttp.delete() for the full list of arguments</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>aiohttp.client_reqrep.ClientResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.ScraperContext.get">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">aiohttp.client_reqrep.ClientResponse</span></span></span><a class="headerlink" href="#sneakpeek.scraper_context.ScraperContext.get" title="Permalink to this definition"></a></dt>
<dd><p>Make GET request to the given URL</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – URL to send GET request to</p></li>
<li><p><strong>headers</strong> (<em>HttpHeaders</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – HTTP headers. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> – See aiohttp.get() for the full list of arguments</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>aiohttp.client_reqrep.ClientResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.ScraperContext.head">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">head</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">aiohttp.client_reqrep.ClientResponse</span></span></span><a class="headerlink" href="#sneakpeek.scraper_context.ScraperContext.head" title="Permalink to this definition"></a></dt>
<dd><p>Make HEAD request to the given URL</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – URL to send HEAD request to</p></li>
<li><p><strong>headers</strong> (<em>HttpHeaders</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – HTTP headers. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> – See aiohttp.head() for the full list of arguments</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>aiohttp.client_reqrep.ClientResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.ScraperContext.options">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">aiohttp.client_reqrep.ClientResponse</span></span></span><a class="headerlink" href="#sneakpeek.scraper_context.ScraperContext.options" title="Permalink to this definition"></a></dt>
<dd><p>Make OPTIONS request to the given URL</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – URL to send OPTIONS request to</p></li>
<li><p><strong>headers</strong> (<em>HttpHeaders</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – HTTP headers. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> – See aiohttp.options() for the full list of arguments</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>aiohttp.client_reqrep.ClientResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.ScraperContext.ping_session">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">ping_session</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.scraper_context.ScraperContext.ping_session" title="Permalink to this definition"></a></dt>
<dd><p>Ping scraper job, so it’s not considered dead</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.ScraperContext.post">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">aiohttp.client_reqrep.ClientResponse</span></span></span><a class="headerlink" href="#sneakpeek.scraper_context.ScraperContext.post" title="Permalink to this definition"></a></dt>
<dd><p>Make POST request to the given URL</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – URL to send POST request to</p></li>
<li><p><strong>headers</strong> (<em>HttpHeaders</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – HTTP headers. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> – See aiohttp.get() for the full list of arguments</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>aiohttp.client_reqrep.ClientResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.scraper_context.ScraperContext.put">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">put</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">url</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">headers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">aiohttp.client_reqrep.ClientResponse</span></span></span><a class="headerlink" href="#sneakpeek.scraper_context.ScraperContext.put" title="Permalink to this definition"></a></dt>
<dd><p>Make PUT request to the given URL</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>url</strong> (<em>str</em>) – URL to send PUT request to</p></li>
<li><p><strong>headers</strong> (<em>HttpHeaders</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – HTTP headers. Defaults to None.</p></li>
<li><p><strong>**kwargs</strong> – See aiohttp.put() for the full list of arguments</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>aiohttp.client_reqrep.ClientResponse</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-sneakpeek.scraper_handler"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.scraper_handler.ScraperHandler">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.scraper_handler.</span></span><span class="sig-name descname"><span class="pre">ScraperHandler</span></span><a class="headerlink" href="#sneakpeek.scraper_handler.ScraperHandler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Abstract class that scraper logic handler must implement</p>
<dl class="py property">
<dt class="sig sig-object py" id="sneakpeek.scraper_handler.ScraperHandler.name">
<em class="property"><span class="pre">abstract</span> <span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#sneakpeek.scraper_handler.ScraperHandler.name" title="Permalink to this definition"></a></dt>
<dd><p>Name of the handler</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.scraper_handler.ScraperHandler.run">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">context</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.scraper_context.ScraperContext" title="sneakpeek.scraper_context.ScraperContext"><span class="pre">sneakpeek.scraper_context.ScraperContext</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#sneakpeek.scraper_handler.ScraperHandler.run" title="Permalink to this definition"></a></dt>
<dd><p>Execute scraper logic</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>context</strong> (<a class="reference internal" href="#sneakpeek.scraper_context.ScraperContext" title="sneakpeek.scraper_context.ScraperContext"><em>ScraperContext</em></a>) – Scraper context</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>scraper result that will be persisted in the storage (should be relatively small information to give sense on job result)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-sneakpeek.lib.models"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.models.Lease">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.models.</span></span><span class="sig-name descname"><span class="pre">Lease</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">owner_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acquired</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">datetime.datetime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acquired_until</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">datetime.datetime</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.models.Lease" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<p>Lease metadata</p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises ValidationError if the input data cannot be parsed to form a valid model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – </p></li>
<li><p><strong>owner_id</strong> (<em>str</em>) – </p></li>
<li><p><strong>acquired</strong> (<em>datetime.datetime</em>) – </p></li>
<li><p><strong>acquired_until</strong> (<em>datetime.datetime</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.Lease.acquired">
<span class="sig-name descname"><span class="pre">acquired</span></span><em class="property"><span class="pre">:</span> <span class="pre">datetime.datetime</span></em><a class="headerlink" href="#sneakpeek.lib.models.Lease.acquired" title="Permalink to this definition"></a></dt>
<dd><p>Time when the lease was acquired</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.Lease.acquired_until">
<span class="sig-name descname"><span class="pre">acquired_until</span></span><em class="property"><span class="pre">:</span> <span class="pre">datetime.datetime</span></em><a class="headerlink" href="#sneakpeek.lib.models.Lease.acquired_until" title="Permalink to this definition"></a></dt>
<dd><p>Time until the lease is acquired</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.Lease.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#sneakpeek.lib.models.Lease.name" title="Permalink to this definition"></a></dt>
<dd><p>Lease name (resource name to be locked)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.Lease.owner_id">
<span class="sig-name descname"><span class="pre">owner_id</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#sneakpeek.lib.models.Lease.owner_id" title="Permalink to this definition"></a></dt>
<dd><p>ID of the acquirer (should be the same if you already have the lease and want to prolong it)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.models.Scraper">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.models.</span></span><span class="sig-name descname"><span class="pre">Scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">schedule</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperSchedule" title="sneakpeek.lib.models.ScraperSchedule"><span class="pre">sneakpeek.lib.models.ScraperSchedule</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">schedule_crontab</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">handler</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.scraper_config.ScraperConfig" title="sneakpeek.scraper_config.ScraperConfig"><span class="pre">sneakpeek.scraper_config.ScraperConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">schedule_priority</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><span class="pre">sneakpeek.lib.models.ScraperJobPriority</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">ScraperJobPriority.NORMAL</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.models.Scraper" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<p>Scraper metadata</p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises ValidationError if the input data cannot be parsed to form a valid model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>int</em>) – </p></li>
<li><p><strong>name</strong> (<em>str</em>) – </p></li>
<li><p><strong>schedule</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperSchedule" title="sneakpeek.lib.models.ScraperSchedule"><em>sneakpeek.lib.models.ScraperSchedule</em></a>) – </p></li>
<li><p><strong>schedule_crontab</strong> (<em>str</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>handler</strong> (<em>str</em>) – </p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#sneakpeek.scraper_config.ScraperConfig" title="sneakpeek.scraper_config.ScraperConfig"><em>sneakpeek.scraper_config.ScraperConfig</em></a>) – </p></li>
<li><p><strong>schedule_priority</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><em>sneakpeek.lib.models.ScraperJobPriority</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.Scraper.config">
<span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="#sneakpeek.scraper_config.ScraperConfig" title="sneakpeek.scraper_config.ScraperConfig"><span class="pre">sneakpeek.scraper_config.ScraperConfig</span></a></em><a class="headerlink" href="#sneakpeek.lib.models.Scraper.config" title="Permalink to this definition"></a></dt>
<dd><p>Scraper configuration that is passed to the handler</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.Scraper.handler">
<span class="sig-name descname"><span class="pre">handler</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#sneakpeek.lib.models.Scraper.handler" title="Permalink to this definition"></a></dt>
<dd><p>Name of the scraper handler that implements scraping logic</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.Scraper.id">
<span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#sneakpeek.lib.models.Scraper.id" title="Permalink to this definition"></a></dt>
<dd><p>Scraper unique identifier</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.Scraper.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#sneakpeek.lib.models.Scraper.name" title="Permalink to this definition"></a></dt>
<dd><p>Scraper name</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.Scraper.schedule">
<span class="sig-name descname"><span class="pre">schedule</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="#sneakpeek.lib.models.ScraperSchedule" title="sneakpeek.lib.models.ScraperSchedule"><span class="pre">sneakpeek.lib.models.ScraperSchedule</span></a></em><a class="headerlink" href="#sneakpeek.lib.models.Scraper.schedule" title="Permalink to this definition"></a></dt>
<dd><p>Scraper schedule configuration</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.Scraper.schedule_crontab">
<span class="sig-name descname"><span class="pre">schedule_crontab</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></em><a class="headerlink" href="#sneakpeek.lib.models.Scraper.schedule_crontab" title="Permalink to this definition"></a></dt>
<dd><p>Must be defined if schedule equals to <code class="docutils literal notranslate"><span class="pre">CRONTAB</span></code></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.Scraper.schedule_priority">
<span class="sig-name descname"><span class="pre">schedule_priority</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><span class="pre">sneakpeek.lib.models.ScraperJobPriority</span></a></em><a class="headerlink" href="#sneakpeek.lib.models.Scraper.schedule_priority" title="Permalink to this definition"></a></dt>
<dd><p>Default priority to enqueue scraper jobs with</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJob">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.models.</span></span><span class="sig-name descname"><span class="pre">ScraperJob</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scraper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJobStatus" title="sneakpeek.lib.models.ScraperJobStatus"><span class="pre">sneakpeek.lib.models.ScraperJobStatus</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><span class="pre">sneakpeek.lib.models.ScraperJobPriority</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">created_at</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">datetime.datetime</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">started_at</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">datetime.datetime</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_active_at</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">datetime.datetime</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finished_at</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">datetime.datetime</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.models.ScraperJob" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<p>Scraper job metadata</p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises ValidationError if the input data cannot be parsed to form a valid model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>id</strong> (<em>int</em>) – </p></li>
<li><p><strong>scraper</strong> (<a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><em>sneakpeek.lib.models.Scraper</em></a>) – </p></li>
<li><p><strong>status</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJobStatus" title="sneakpeek.lib.models.ScraperJobStatus"><em>sneakpeek.lib.models.ScraperJobStatus</em></a>) – </p></li>
<li><p><strong>priority</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><em>sneakpeek.lib.models.ScraperJobPriority</em></a>) – </p></li>
<li><p><strong>created_at</strong> (<em>datetime.datetime</em>) – </p></li>
<li><p><strong>started_at</strong> (<em>datetime.datetime</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>last_active_at</strong> (<em>datetime.datetime</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>finished_at</strong> (<em>datetime.datetime</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>result</strong> (<em>str</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJob.created_at">
<span class="sig-name descname"><span class="pre">created_at</span></span><em class="property"><span class="pre">:</span> <span class="pre">datetime.datetime</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJob.created_at" title="Permalink to this definition"></a></dt>
<dd><p>When the job was created and enqueued</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJob.finished_at">
<span class="sig-name descname"><span class="pre">finished_at</span></span><em class="property"><span class="pre">:</span> <span class="pre">datetime.datetime</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJob.finished_at" title="Permalink to this definition"></a></dt>
<dd><p>When the job finished</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJob.id">
<span class="sig-name descname"><span class="pre">id</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJob.id" title="Permalink to this definition"></a></dt>
<dd><p>Job unique identifier</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJob.last_active_at">
<span class="sig-name descname"><span class="pre">last_active_at</span></span><em class="property"><span class="pre">:</span> <span class="pre">datetime.datetime</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJob.last_active_at" title="Permalink to this definition"></a></dt>
<dd><p>When the job last sent heartbeat</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJob.priority">
<span class="sig-name descname"><span class="pre">priority</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><span class="pre">sneakpeek.lib.models.ScraperJobPriority</span></a></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJob.priority" title="Permalink to this definition"></a></dt>
<dd><p>Scraper job priority</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJob.result">
<span class="sig-name descname"><span class="pre">result</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJob.result" title="Permalink to this definition"></a></dt>
<dd><p>Information with the job result (should be rather small and should summarize the outcome of the scraping)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJob.scraper">
<span class="sig-name descname"><span class="pre">scraper</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJob.scraper" title="Permalink to this definition"></a></dt>
<dd><p>Scraper metadata</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJob.started_at">
<span class="sig-name descname"><span class="pre">started_at</span></span><em class="property"><span class="pre">:</span> <span class="pre">datetime.datetime</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJob.started_at" title="Permalink to this definition"></a></dt>
<dd><p>When the job was dequeued and started being processed by the worker</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJob.status">
<span class="sig-name descname"><span class="pre">status</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="#sneakpeek.lib.models.ScraperJobStatus" title="sneakpeek.lib.models.ScraperJobStatus"><span class="pre">sneakpeek.lib.models.ScraperJobStatus</span></a></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJob.status" title="Permalink to this definition"></a></dt>
<dd><p>Scraper job status</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJobPriority">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.models.</span></span><span class="sig-name descname"><span class="pre">ScraperJobPriority</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.models.ScraperJobPriority" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Priority of the scraper job</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJobPriority.HIGH">
<span class="sig-name descname"><span class="pre">HIGH</span></span><em class="property"> <span class="pre">=</span> <span class="pre">1</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJobPriority.HIGH" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJobPriority.NORMAL">
<span class="sig-name descname"><span class="pre">NORMAL</span></span><em class="property"> <span class="pre">=</span> <span class="pre">2</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJobPriority.NORMAL" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJobPriority.UTMOST">
<span class="sig-name descname"><span class="pre">UTMOST</span></span><em class="property"> <span class="pre">=</span> <span class="pre">0</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJobPriority.UTMOST" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJobStatus">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.models.</span></span><span class="sig-name descname"><span class="pre">ScraperJobStatus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.models.ScraperJobStatus" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Scraper job status</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJobStatus.DEAD">
<span class="sig-name descname"><span class="pre">DEAD</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'dead'</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJobStatus.DEAD" title="Permalink to this definition"></a></dt>
<dd><p>Scraper job was inactive for a while, so scheduler marked it as dead and scheduler can schedule scraper again</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJobStatus.FAILED">
<span class="sig-name descname"><span class="pre">FAILED</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'failed'</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJobStatus.FAILED" title="Permalink to this definition"></a></dt>
<dd><p>Scraper job failed</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJobStatus.KILLED">
<span class="sig-name descname"><span class="pre">KILLED</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'killed'</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJobStatus.KILLED" title="Permalink to this definition"></a></dt>
<dd><p>Scraper job was killed by the user</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJobStatus.PENDING">
<span class="sig-name descname"><span class="pre">PENDING</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'pending'</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJobStatus.PENDING" title="Permalink to this definition"></a></dt>
<dd><p>Scraper job is in the queue</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJobStatus.STARTED">
<span class="sig-name descname"><span class="pre">STARTED</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'started'</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJobStatus.STARTED" title="Permalink to this definition"></a></dt>
<dd><p>Scraper job was dequeued by the worker and is being processed</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperJobStatus.SUCCEEDED">
<span class="sig-name descname"><span class="pre">SUCCEEDED</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'succeeded'</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperJobStatus.SUCCEEDED" title="Permalink to this definition"></a></dt>
<dd><p>Scraper job succeeded</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperSchedule">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.models.</span></span><span class="sig-name descname"><span class="pre">ScraperSchedule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.models.ScraperSchedule" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Scraper schedule options. Note that it’s disallowed to have 2 concurrent
scraper jobs, so if there’s an active scraper job new job won’t be scheduled</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperSchedule.CRONTAB">
<span class="sig-name descname"><span class="pre">CRONTAB</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'crontab'</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperSchedule.CRONTAB" title="Permalink to this definition"></a></dt>
<dd><p>Specify crontab when scraper should be scheduled</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperSchedule.EVERY_DAY">
<span class="sig-name descname"><span class="pre">EVERY_DAY</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'every_day'</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperSchedule.EVERY_DAY" title="Permalink to this definition"></a></dt>
<dd><p>Scraper will be scheduled every day</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperSchedule.EVERY_HOUR">
<span class="sig-name descname"><span class="pre">EVERY_HOUR</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'every_hour'</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperSchedule.EVERY_HOUR" title="Permalink to this definition"></a></dt>
<dd><p>Scraper will be scheduled every hour</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperSchedule.EVERY_MINUTE">
<span class="sig-name descname"><span class="pre">EVERY_MINUTE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'every_minute'</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperSchedule.EVERY_MINUTE" title="Permalink to this definition"></a></dt>
<dd><p>Scraper will be scheduled every minute</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperSchedule.EVERY_MONTH">
<span class="sig-name descname"><span class="pre">EVERY_MONTH</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'every_month'</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperSchedule.EVERY_MONTH" title="Permalink to this definition"></a></dt>
<dd><p>Scraper will be scheduled every month</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperSchedule.EVERY_SECOND">
<span class="sig-name descname"><span class="pre">EVERY_SECOND</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'every_second'</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperSchedule.EVERY_SECOND" title="Permalink to this definition"></a></dt>
<dd><p>Scraper will be scheduled every second</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperSchedule.EVERY_WEEK">
<span class="sig-name descname"><span class="pre">EVERY_WEEK</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'every_week'</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperSchedule.EVERY_WEEK" title="Permalink to this definition"></a></dt>
<dd><p>Scraper will be scheduled every week</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.lib.models.ScraperSchedule.INACTIVE">
<span class="sig-name descname"><span class="pre">INACTIVE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'inactive'</span></em><a class="headerlink" href="#sneakpeek.lib.models.ScraperSchedule.INACTIVE" title="Permalink to this definition"></a></dt>
<dd><p>Scraper won’t be automatically scheduled</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-sneakpeek.scheduler"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.scheduler.Scheduler">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.scheduler.</span></span><span class="sig-name descname"><span class="pre">Scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scrapers_storage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.storage.base.ScrapersStorage" title="sneakpeek.lib.storage.base.ScrapersStorage"><span class="pre">sneakpeek.lib.storage.base.ScrapersStorage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs_storage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.storage.base.ScraperJobsStorage" title="sneakpeek.lib.storage.base.ScraperJobsStorage"><span class="pre">sneakpeek.lib.storage.base.ScraperJobsStorage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">lease_storage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.storage.base.LeaseStorage" title="sneakpeek.lib.storage.base.LeaseStorage"><span class="pre">sneakpeek.lib.storage.base.LeaseStorage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.queue.QueueABC" title="sneakpeek.lib.queue.QueueABC"><span class="pre">sneakpeek.lib.queue.QueueABC</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage_poll_frequency</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">datetime.timedelta</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">datetime.timedelta(seconds=5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lease_duration</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">datetime.timedelta</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">datetime.timedelta(seconds=60)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs_to_keep</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.scheduler.Scheduler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sneakpeek.scheduler.SchedulerABC" title="sneakpeek.scheduler.SchedulerABC"><code class="xref py py-class docutils literal notranslate"><span class="pre">sneakpeek.scheduler.SchedulerABC</span></code></a></p>
<p>Sneakpeeker scheduler - schedules scrapers and performs maintenance jobs. Uses APScheduler under the hood.</p>
<p>Initialize scheduler</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scrapers_storage</strong> (<a class="reference internal" href="#sneakpeek.lib.storage.base.ScrapersStorage" title="sneakpeek.lib.storage.base.ScrapersStorage"><em>ScrapersStorage</em></a>) – Scrapers storage</p></li>
<li><p><strong>jobs_storage</strong> (<a class="reference internal" href="#sneakpeek.lib.storage.base.ScraperJobsStorage" title="sneakpeek.lib.storage.base.ScraperJobsStorage"><em>ScraperJobsStorage</em></a>) – Jobs storage</p></li>
<li><p><strong>lease_storage</strong> (<a class="reference internal" href="#sneakpeek.lib.storage.base.LeaseStorage" title="sneakpeek.lib.storage.base.LeaseStorage"><em>LeaseStorage</em></a>) – Lease storage</p></li>
<li><p><strong>queue</strong> (<a class="reference internal" href="#sneakpeek.lib.queue.Queue" title="sneakpeek.lib.queue.Queue"><em>Queue</em></a>) – Sneakpeek queue implementation</p></li>
<li><p><strong>storage_poll_frequency</strong> (<em>timedelta</em><em>, </em><em>optional</em>) – How much scheduler wait before polling storage for scrapers updates. Defaults to 5 seconds.</p></li>
<li><p><strong>lease_duration</strong> (<em>timedelta</em><em>, </em><em>optional</em>) – How long scheduler lease lasts. Lease is required for scheduler to be able to create new scraper jobs. This is needed so at any point of time there’s only one active scheduler instance. Defaults to 1 minute.</p></li>
<li><p><strong>jobs_to_keep</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of historical scraper jobs to keep in the storage. Storage is cleaned up every 10 minutes. Defaults to 100.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.scheduler.SchedulerABC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.scheduler.</span></span><span class="sig-name descname"><span class="pre">SchedulerABC</span></span><a class="headerlink" href="#sneakpeek.scheduler.SchedulerABC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
</dd></dl>

<span class="target" id="module-sneakpeek.worker"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.worker.Worker">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.worker.</span></span><span class="sig-name descname"><span class="pre">Worker</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">runner</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.runner.RunnerABC" title="sneakpeek.runner.RunnerABC"><span class="pre">sneakpeek.runner.RunnerABC</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.queue.QueueABC" title="sneakpeek.lib.queue.QueueABC"><span class="pre">sneakpeek.lib.queue.QueueABC</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">loop</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">asyncio.events.AbstractEventLoop</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_concurrency</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.worker.Worker" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sneakpeek.worker.WorkerABC" title="sneakpeek.worker.WorkerABC"><code class="xref py py-class docutils literal notranslate"><span class="pre">sneakpeek.worker.WorkerABC</span></code></a></p>
<p>Sneakpeeker worker - consumes scraper jobs queue and executes scapers logic</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>runner</strong> (<a class="reference internal" href="#sneakpeek.runner.RunnerABC" title="sneakpeek.runner.RunnerABC"><em>RunnerABC</em></a>) – Scraper runner</p></li>
<li><p><strong>queue</strong> (<a class="reference internal" href="#sneakpeek.lib.queue.Queue" title="sneakpeek.lib.queue.Queue"><em>Queue</em></a>) – Sneakpeek queue implementation</p></li>
<li><p><strong>loop</strong> (<em>asyncio.AbstractEventLoop</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – AsyncIO loop to use. In case it’s None result of <cite>asyncio.get_event_loop()</cite> will be used. Defaults to None.</p></li>
<li><p><strong>max_concurrency</strong> (<em>int</em><em>, </em><em>optional</em>) – Maximum number of concurrent scraper jobs. Defaults to 50.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.worker.WorkerABC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.worker.</span></span><span class="sig-name descname"><span class="pre">WorkerABC</span></span><a class="headerlink" href="#sneakpeek.worker.WorkerABC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
</dd></dl>

<span class="target" id="module-sneakpeek.runner"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.runner.LocalRunner">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.runner.</span></span><span class="sig-name descname"><span class="pre">LocalRunner</span></span><a class="headerlink" href="#sneakpeek.runner.LocalRunner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Scraper runner that is meant to be used for local debugging</p>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.runner.LocalRunner.run_async">
<em class="property"><span class="pre">async</span> <span class="pre">static</span> </em><span class="sig-name descname"><span class="pre">run_async</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">handler</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.scraper_handler.ScraperHandler" title="sneakpeek.scraper_handler.ScraperHandler"><span class="pre">sneakpeek.scraper_handler.ScraperHandler</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.scraper_config.ScraperConfig" title="sneakpeek.scraper_config.ScraperConfig"><span class="pre">sneakpeek.scraper_config.ScraperConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">plugins</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.scraper_context.BeforeRequestPlugin" title="sneakpeek.scraper_context.BeforeRequestPlugin"><span class="pre">sneakpeek.scraper_context.BeforeRequestPlugin</span></a> <span class="p"><span class="pre">|</span></span> <a class="reference internal" href="#sneakpeek.scraper_context.AfterResponsePlugin" title="sneakpeek.scraper_context.AfterResponsePlugin"><span class="pre">sneakpeek.scraper_context.AfterResponsePlugin</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logging_level</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.runner.LocalRunner.run_async" title="Permalink to this definition"></a></dt>
<dd><p>Execute scraper locally.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference internal" href="#sneakpeek.scraper_config.ScraperConfig" title="sneakpeek.scraper_config.ScraperConfig"><em>ScraperConfig</em></a>) – Scraper config</p></li>
<li><p><strong>handler</strong> (<a class="reference internal" href="#sneakpeek.scraper_handler.ScraperHandler" title="sneakpeek.scraper_handler.ScraperHandler"><em>sneakpeek.scraper_handler.ScraperHandler</em></a>) – </p></li>
<li><p><strong>plugins</strong> (<em>Optional</em><em>[</em><em>list</em><em>[</em><a class="reference internal" href="#sneakpeek.scraper_context.BeforeRequestPlugin" title="sneakpeek.scraper_context.BeforeRequestPlugin"><em>sneakpeek.scraper_context.BeforeRequestPlugin</em></a><em> | </em><a class="reference internal" href="#sneakpeek.scraper_context.AfterResponsePlugin" title="sneakpeek.scraper_context.AfterResponsePlugin"><em>sneakpeek.scraper_context.AfterResponsePlugin</em></a><em>]</em><em>]</em>) – </p></li>
<li><p><strong>logging_level</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.runner.Runner">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.runner.</span></span><span class="sig-name descname"><span class="pre">Runner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">handlers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.scraper_handler.ScraperHandler" title="sneakpeek.scraper_handler.ScraperHandler"><span class="pre">sneakpeek.scraper_handler.ScraperHandler</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.queue.QueueABC" title="sneakpeek.lib.queue.QueueABC"><span class="pre">sneakpeek.lib.queue.QueueABC</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">storage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.storage.base.ScraperJobsStorage" title="sneakpeek.lib.storage.base.ScraperJobsStorage"><span class="pre">sneakpeek.lib.storage.base.ScraperJobsStorage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">plugins</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.scraper_context.BeforeRequestPlugin" title="sneakpeek.scraper_context.BeforeRequestPlugin"><span class="pre">sneakpeek.scraper_context.BeforeRequestPlugin</span></a> <span class="p"><span class="pre">|</span></span> <a class="reference internal" href="#sneakpeek.scraper_context.AfterResponsePlugin" title="sneakpeek.scraper_context.AfterResponsePlugin"><span class="pre">sneakpeek.scraper_context.AfterResponsePlugin</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.runner.Runner" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sneakpeek.runner.RunnerABC" title="sneakpeek.runner.RunnerABC"><code class="xref py py-class docutils literal notranslate"><span class="pre">sneakpeek.runner.RunnerABC</span></code></a></p>
<p>Default scraper runner implementation that is meant to be used in the Sneakpeek server</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>handlers</strong> (<em>list</em><em>[</em><a class="reference internal" href="#sneakpeek.scraper_handler.ScraperHandler" title="sneakpeek.scraper_handler.ScraperHandler"><em>ScraperHandler</em></a><em>]</em>) – List of handlers that implement scraper logic</p></li>
<li><p><strong>queue</strong> (<a class="reference internal" href="#sneakpeek.lib.queue.Queue" title="sneakpeek.lib.queue.Queue"><em>Queue</em></a>) – Sneakpeek queue implementation</p></li>
<li><p><strong>storage</strong> (<em>Storage</em>) – Sneakpeek storage implementation</p></li>
<li><p><strong>plugins</strong> (<em>list</em><em>[</em><em>Plugin</em><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – List of plugins that will be used by scraper runner. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.runner.Runner.run">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">job</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.runner.Runner.run" title="Permalink to this definition"></a></dt>
<dd><p>Execute scraper. Following logic is done:</p>
<ul class="simple">
<li><p>Ping scraper job</p></li>
<li><p>Build scraper context</p></li>
<li><p>Execute scraper logic</p></li>
<li><p>[On success] Set scraper job status to <code class="docutils literal notranslate"><span class="pre">SUCCEEDED</span></code></p></li>
<li><p>[On fail] Set scraper job status to <code class="docutils literal notranslate"><span class="pre">FAILED</span></code></p></li>
<li><p>[If the scraper job was killed] Do nothing</p></li>
<li><p>Persist scraper job status</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>job</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><em>ScraperJob</em></a>) – Scraper job metadata</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.runner.RunnerABC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.runner.</span></span><span class="sig-name descname"><span class="pre">RunnerABC</span></span><a class="headerlink" href="#sneakpeek.runner.RunnerABC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Scraper runner - manages scraper job lifecycle and runs the scraper logic</p>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.runner.RunnerABC.run">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">job</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.runner.RunnerABC.run" title="Permalink to this definition"></a></dt>
<dd><p>Execute scraper job</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>job</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><em>ScraperJob</em></a>) – Scraper job metadata</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-sneakpeek.api"></span><dl class="py function">
<dt class="sig sig-object py" id="sneakpeek.api.create_api">
<span class="sig-prename descclassname"><span class="pre">sneakpeek.api.</span></span><span class="sig-name descname"><span class="pre">create_api</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scrapers_storage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.storage.base.ScrapersStorage" title="sneakpeek.lib.storage.base.ScrapersStorage"><span class="pre">sneakpeek.lib.storage.base.ScrapersStorage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs_storage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.storage.base.ScraperJobsStorage" title="sneakpeek.lib.storage.base.ScraperJobsStorage"><span class="pre">sneakpeek.lib.storage.base.ScraperJobsStorage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.queue.QueueABC" title="sneakpeek.lib.queue.QueueABC"><span class="pre">sneakpeek.lib.queue.QueueABC</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">handlers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.scraper_handler.ScraperHandler" title="sneakpeek.scraper_handler.ScraperHandler"><span class="pre">sneakpeek.scraper_handler.ScraperHandler</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">fastapi_jsonrpc.API</span></span></span><a class="headerlink" href="#sneakpeek.api.create_api" title="Permalink to this definition"></a></dt>
<dd><p>Create JsonRPC API (FastAPI is used under the hood)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>storage</strong> (<em>Storage</em>) – Sneakpeek storage implementation</p></li>
<li><p><strong>queue</strong> (<a class="reference internal" href="#sneakpeek.lib.queue.Queue" title="sneakpeek.lib.queue.Queue"><em>Queue</em></a>) – Sneakpeek queue implementation</p></li>
<li><p><strong>handlers</strong> (<em>list</em><em>[</em><a class="reference internal" href="#sneakpeek.scraper_handler.ScraperHandler" title="sneakpeek.scraper_handler.ScraperHandler"><em>ScraperHandler</em></a><em>]</em>) – List of handlers that implement scraper logic</p></li>
<li><p><strong>scrapers_storage</strong> (<a class="reference internal" href="#sneakpeek.lib.storage.base.ScrapersStorage" title="sneakpeek.lib.storage.base.ScrapersStorage"><em>sneakpeek.lib.storage.base.ScrapersStorage</em></a>) – </p></li>
<li><p><strong>jobs_storage</strong> (<a class="reference internal" href="#sneakpeek.lib.storage.base.ScraperJobsStorage" title="sneakpeek.lib.storage.base.ScraperJobsStorage"><em>sneakpeek.lib.storage.base.ScraperJobsStorage</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>fastapi_jsonrpc.API</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sneakpeek.api.get_api_entrypoint">
<span class="sig-prename descclassname"><span class="pre">sneakpeek.api.</span></span><span class="sig-name descname"><span class="pre">get_api_entrypoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scrapers_storage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.storage.base.ScrapersStorage" title="sneakpeek.lib.storage.base.ScrapersStorage"><span class="pre">sneakpeek.lib.storage.base.ScrapersStorage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobs_storage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.storage.base.ScraperJobsStorage" title="sneakpeek.lib.storage.base.ScraperJobsStorage"><span class="pre">sneakpeek.lib.storage.base.ScraperJobsStorage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.queue.Queue" title="sneakpeek.lib.queue.Queue"><span class="pre">sneakpeek.lib.queue.Queue</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">handlers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.scraper_handler.ScraperHandler" title="sneakpeek.scraper_handler.ScraperHandler"><span class="pre">sneakpeek.scraper_handler.ScraperHandler</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">fastapi_jsonrpc.Entrypoint</span></span></span><a class="headerlink" href="#sneakpeek.api.get_api_entrypoint" title="Permalink to this definition"></a></dt>
<dd><p>Create public JsonRPC API entrypoint (mostly mimics storage and queue API)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>storage</strong> (<em>Storage</em>) – Sneakpeek storage implementation</p></li>
<li><p><strong>queue</strong> (<a class="reference internal" href="#sneakpeek.lib.queue.Queue" title="sneakpeek.lib.queue.Queue"><em>Queue</em></a>) – Sneakpeek queue implementation</p></li>
<li><p><strong>handlers</strong> (<em>list</em><em>[</em><a class="reference internal" href="#sneakpeek.scraper_handler.ScraperHandler" title="sneakpeek.scraper_handler.ScraperHandler"><em>ScraperHandler</em></a><em>]</em>) – List of handlers that implement scraper logic</p></li>
<li><p><strong>scrapers_storage</strong> (<a class="reference internal" href="#sneakpeek.lib.storage.base.ScrapersStorage" title="sneakpeek.lib.storage.base.ScrapersStorage"><em>sneakpeek.lib.storage.base.ScrapersStorage</em></a>) – </p></li>
<li><p><strong>jobs_storage</strong> (<a class="reference internal" href="#sneakpeek.lib.storage.base.ScraperJobsStorage" title="sneakpeek.lib.storage.base.ScraperJobsStorage"><em>sneakpeek.lib.storage.base.ScraperJobsStorage</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>FastAPI JsonRPC entrypoint</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>jsonrpc.Entrypoint</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-sneakpeek.metrics"></span><dl class="py function">
<dt class="sig sig-object py" id="sneakpeek.metrics.count_invocations">
<span class="sig-prename descclassname"><span class="pre">sneakpeek.metrics.</span></span><span class="sig-name descname"><span class="pre">count_invocations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subsystem</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.metrics.count_invocations" title="Permalink to this definition"></a></dt>
<dd><p>Decorator for measuring number of function invocations (works for both sync and async functions).</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@count_invocations</span><span class="p">(</span><span class="n">subsytem</span><span class="o">=</span><span class="s2">&quot;my subsystem&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_awesome_func</span><span class="p">():</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>This will export following Prometheus counter metrics:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Total number of invocations</span>
<span class="n">sneakpeek_invocations</span><span class="p">{</span><span class="n">subsystem</span><span class="o">=</span><span class="s2">&quot;my subsystem&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;my_awesome_func&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;total&quot;</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">}</span>
<span class="c1"># Total number of successful invocations (ones that haven&#39;t thrown an exception)</span>
<span class="n">sneakpeek_invocations</span><span class="p">{</span><span class="n">subsystem</span><span class="o">=</span><span class="s2">&quot;my subsystem&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;my_awesome_func&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">}</span>
<span class="c1"># Total number of failed invocations (ones that have thrown an exception)</span>
<span class="n">sneakpeek_invocations</span><span class="p">{</span><span class="n">subsystem</span><span class="o">=</span><span class="s2">&quot;my subsystem&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;my_awesome_func&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="s2">&quot;&lt;Exception class name&gt;&quot;</span><span class="p">}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>subsystem</strong> (<em>str</em>) – Subsystem name to be used in the metric annotation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sneakpeek.metrics.measure_latency">
<span class="sig-prename descclassname"><span class="pre">sneakpeek.metrics.</span></span><span class="sig-name descname"><span class="pre">measure_latency</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subsystem</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.metrics.measure_latency" title="Permalink to this definition"></a></dt>
<dd><p>Decorator for measuring latency of the function (works for both sync and async functions).</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@measure_latency</span><span class="p">(</span><span class="n">subsytem</span><span class="o">=</span><span class="s2">&quot;my subsystem&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">my_awesome_func</span><span class="p">():</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>This will export following Prometheus histogram metric:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">sneakpeek_latency</span><span class="p">{</span><span class="n">subsystem</span><span class="o">=</span><span class="s2">&quot;my subsystem&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;my_awesome_func&quot;</span><span class="p">}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>subsystem</strong> (<em>str</em>) – Subsystem name to be used in the metric annotation</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-sneakpeek.logging"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.logging.ScraperContextInjectingFilter">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.logging.</span></span><span class="sig-name descname"><span class="pre">ScraperContextInjectingFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.logging.ScraperContextInjectingFilter" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">logging.Filter</span></code></p>
<p>Scraper context filter which automatically injects
scraper and scraper job IDs to the logging metadata.</p>
<p>Example of usage:</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>
<span class="n">handler</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">()</span>
<span class="n">handler</span><span class="o">.</span><span class="n">addFilter</span><span class="p">(</span><span class="n">ScraperContextInjectingFilter</span><span class="p">())</span>
<span class="n">logger</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
</pre></div>
</div>
<p>Initialize a filter.</p>
<p>Initialize with the name of the logger which, together with its
children, will have its events allowed through the filter. If no
name is specified, allow every event.</p>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.logging.ScraperContextInjectingFilter.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">logging.LogRecord</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#sneakpeek.logging.ScraperContextInjectingFilter.filter" title="Permalink to this definition"></a></dt>
<dd><p>Injects scraper metadata into log record:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scraper_job_id</span></code> - Scraper Job ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scraper_id</span></code> - Scraper ID</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scraper_name</span></code> - Scraper name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scraper_handler</span></code> - Scraper logic implementation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scraper_job_human_name</span></code> - Formatted scraper job ID (<code class="docutils literal notranslate"><span class="pre">&lt;name&gt;::&lt;scraper_id&gt;::&lt;scraper_job_id&gt;</span></code>)</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>record</strong> (<em>logging.LogRecord</em>) – Log record to inject metadata into</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Always True</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sneakpeek.logging.configure_logging">
<span class="sig-prename descclassname"><span class="pre">sneakpeek.logging.</span></span><span class="sig-name descname"><span class="pre">configure_logging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.logging.configure_logging" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to configure logging:</p>
<ul class="simple">
<li><p>Adds console logger to the root logger</p></li>
<li><p>Adds scraper context injector filter to the console logger</p></li>
<li><p>Configures console formatting to use scraper metadata</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>level</strong> (<em>int</em><em>, </em><em>optional</em>) – Minimum logging level. Defaults to logging.INFO.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sneakpeek.logging.scraper_job_context">
<span class="sig-prename descclassname"><span class="pre">sneakpeek.logging.</span></span><span class="sig-name descname"><span class="pre">scraper_job_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper_job</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.logging.scraper_job_context" title="Permalink to this definition"></a></dt>
<dd><p>Initialize scraper job logging context which automatically adds
scraper and scraper job IDs to the logging metadata</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper_job</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><em>ScraperJob</em></a>) – Scraper job definition</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-sneakpeek.lib.errors"></span><dl class="py exception">
<dt class="sig sig-object py" id="sneakpeek.lib.errors.ScraperHasActiveRunError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.errors.</span></span><span class="sig-name descname"><span class="pre">ScraperHasActiveRunError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.errors.ScraperHasActiveRunError" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">fastapi_jsonrpc.BaseError</span></code></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="sneakpeek.lib.errors.ScraperJobNotFoundError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.errors.</span></span><span class="sig-name descname"><span class="pre">ScraperJobNotFoundError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.errors.ScraperJobNotFoundError" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">fastapi_jsonrpc.BaseError</span></code></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="sneakpeek.lib.errors.ScraperJobPingFinishedError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.errors.</span></span><span class="sig-name descname"><span class="pre">ScraperJobPingFinishedError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.errors.ScraperJobPingFinishedError" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">fastapi_jsonrpc.BaseError</span></code></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="sneakpeek.lib.errors.ScraperJobPingNotStartedError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.errors.</span></span><span class="sig-name descname"><span class="pre">ScraperJobPingNotStartedError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.errors.ScraperJobPingNotStartedError" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">fastapi_jsonrpc.BaseError</span></code></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="sneakpeek.lib.errors.ScraperNotFoundError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.errors.</span></span><span class="sig-name descname"><span class="pre">ScraperNotFoundError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.errors.ScraperNotFoundError" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">fastapi_jsonrpc.BaseError</span></code></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="sneakpeek.lib.errors.UnknownScraperHandlerError">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.errors.</span></span><span class="sig-name descname"><span class="pre">UnknownScraperHandlerError</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.errors.UnknownScraperHandlerError" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">fastapi_jsonrpc.BaseError</span></code></p>
</dd></dl>

<span class="target" id="module-sneakpeek.lib.queue"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.queue.Queue">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.queue.</span></span><span class="sig-name descname"><span class="pre">Queue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scrapers_storage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.storage.base.ScrapersStorage" title="sneakpeek.lib.storage.base.ScrapersStorage"><span class="pre">sneakpeek.lib.storage.base.ScrapersStorage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">scraper_jobs_storage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.storage.base.ScraperJobsStorage" title="sneakpeek.lib.storage.base.ScraperJobsStorage"><span class="pre">sneakpeek.lib.storage.base.ScraperJobsStorage</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dead_timeout</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">datetime.timedelta</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">datetime.timedelta(seconds=300)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.queue.Queue" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Default priority queue implementation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scrapers_storage</strong> (<a class="reference internal" href="#sneakpeek.lib.storage.base.ScrapersStorage" title="sneakpeek.lib.storage.base.ScrapersStorage"><em>ScrapersStorage</em></a>) – Scrapers storage</p></li>
<li><p><strong>scraper_jobs_storage</strong> (<a class="reference internal" href="#sneakpeek.lib.storage.base.ScraperJobsStorage" title="sneakpeek.lib.storage.base.ScraperJobsStorage"><em>ScraperJobsStorage</em></a>) – Scraper jobs storage</p></li>
<li><p><strong>dead_timeout</strong> (<em>timedelta</em><em>, </em><em>optional</em>) – If the scraper job hasn’t pinged for the given time period, the job will be marked as dead. Defaults to 5 minute.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.queue.QueueABC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.queue.</span></span><span class="sig-name descname"><span class="pre">QueueABC</span></span><a class="headerlink" href="#sneakpeek.lib.queue.QueueABC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Sneakpeek scraper job priority queue</p>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.queue.QueueABC.dequeue">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">dequeue</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.queue.QueueABC.dequeue" title="Permalink to this definition"></a></dt>
<dd><p>Try to dequeue a job from the queue.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Scraper job metadata if queue wasn’t empty or None otherwise</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.queue.QueueABC.enqueue">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">enqueue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><span class="pre">sneakpeek.lib.models.ScraperJobPriority</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.queue.QueueABC.enqueue" title="Permalink to this definition"></a></dt>
<dd><p>Enqueue scraper job.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scraper_id</strong> (<em>int</em>) – ID of the scraper to enqueue</p></li>
<li><p><strong>priority</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><em>ScraperJobPriority</em></a>) – Priority of the job to enqueue</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Scraper job metadata</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="#sneakpeek.lib.errors.ScraperNotFoundError" title="sneakpeek.lib.errors.ScraperNotFoundError"><strong>ScraperNotFoundError</strong></a> – If scraper doesn’t exist</p></li>
<li><p><a class="reference internal" href="#sneakpeek.lib.errors.ScraperHasActiveRunError" title="sneakpeek.lib.errors.ScraperHasActiveRunError"><strong>ScraperHasActiveRunError</strong></a> – If there are scraper jobs in <code class="docutils literal notranslate"><span class="pre">PENDING</span></code> or <code class="docutils literal notranslate"><span class="pre">STARTED</span></code> state</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.queue.QueueABC.get_queue_len">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_queue_len</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><span class="pre">sneakpeek.lib.models.ScraperJobPriority</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#sneakpeek.lib.queue.QueueABC.get_queue_len" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>priority</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><em>ScraperJobPriority</em></a>) – Queue priority</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of pending items in the queue</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.queue.QueueABC.kill_dead_scraper_jobs">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">kill_dead_scraper_jobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sneakpeek.lib.queue.QueueABC.kill_dead_scraper_jobs" title="Permalink to this definition"></a></dt>
<dd><p>Kill dead scraper jobs for the given scraper</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper_id</strong> (<em>int</em>) – Scraper ID to kill jobs for</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of dead scraper jobs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list[<a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.queue.QueueABC.ping_scraper_job">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">ping_scraper_job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scraper_job_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.queue.QueueABC.ping_scraper_job" title="Permalink to this definition"></a></dt>
<dd><p>Send a heartbeat for the scraper job</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scraper_id</strong> (<em>int</em>) – Scraper ID</p></li>
<li><p><strong>scraper_job_id</strong> (<em>int</em>) – Scraper job ID</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Update scraper job metadata</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference internal" href="#sneakpeek.lib.errors.ScraperNotFoundError" title="sneakpeek.lib.errors.ScraperNotFoundError"><strong>ScraperNotFoundError</strong></a> – If scraper doesn’t exist</p></li>
<li><p><strong>ScraperJobFoundError</strong> – If scraper job doesn’t exist</p></li>
<li><p><a class="reference internal" href="#sneakpeek.lib.errors.ScraperJobPingNotStartedError" title="sneakpeek.lib.errors.ScraperJobPingNotStartedError"><strong>ScraperJobPingNotStartedError</strong></a> – If scraper job is still in the <code class="docutils literal notranslate"><span class="pre">PENDING</span></code> state</p></li>
<li><p><a class="reference internal" href="#sneakpeek.lib.errors.ScraperJobPingFinishedError" title="sneakpeek.lib.errors.ScraperJobPingFinishedError"><strong>ScraperJobPingFinishedError</strong></a> – If scraper job is not in the <code class="docutils literal notranslate"><span class="pre">STARTED</span></code> state but it’s in finished state (e.g. <code class="docutils literal notranslate"><span class="pre">DEAD</span></code>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-sneakpeek.lib.storage.base"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.LeaseStorage">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.storage.base.</span></span><span class="sig-name descname"><span class="pre">LeaseStorage</span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.LeaseStorage" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Sneakpeeker lease storage abstract class</p>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.LeaseStorage.maybe_acquire_lease">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">maybe_acquire_lease</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lease_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">owner_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acquire_for</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">datetime.timedelta</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Lease" title="sneakpeek.lib.models.Lease"><span class="pre">sneakpeek.lib.models.Lease</span></a> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.LeaseStorage.maybe_acquire_lease" title="Permalink to this definition"></a></dt>
<dd><p>Try to acquire lease (global lock).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lease_name</strong> (<em>str</em>) – Lease name (resource name to be locked)</p></li>
<li><p><strong>owner_id</strong> (<em>str</em>) – ID of the acquirer (should be the same if you already have the lease and want to prolong it)</p></li>
<li><p><strong>acquire_for</strong> (<em>timedelta</em>) – For how long lease will be acquired</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Lease metadata if it was acquired, None otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Lease" title="sneakpeek.lib.models.Lease">Lease</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.LeaseStorage.release_lease">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">release_lease</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lease_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">owner_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.LeaseStorage.release_lease" title="Permalink to this definition"></a></dt>
<dd><p>Release lease (global lock)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lease_name</strong> (<em>str</em>) – Lease name (resource name to be unlocked)</p></li>
<li><p><strong>owner_id</strong> (<em>str</em>) – ID of the acquirer</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScraperJobsStorage">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.storage.base.</span></span><span class="sig-name descname"><span class="pre">ScraperJobsStorage</span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScraperJobsStorage" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Sneakpeeker storage scraper jobs storage abstract class</p>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScraperJobsStorage.add_scraper_job">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">add_scraper_job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper_job</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScraperJobsStorage.add_scraper_job" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper_job</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><em>ScraperJob</em></a>) – scraper job to add</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Created scraper job</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScraperJobsStorage.delete_old_scraper_jobs">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">delete_old_scraper_jobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_last</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScraperJobsStorage.delete_old_scraper_jobs" title="Permalink to this definition"></a></dt>
<dd><p>Delete old historical scraper jobs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>keep_last</strong> (<em>int</em><em>, </em><em>optional</em>) – How many historical scraper jobs to keep. Defaults to 50.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScraperJobsStorage.dequeue_scraper_job">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">dequeue_scraper_job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><span class="pre">sneakpeek.lib.models.ScraperJobPriority</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScraperJobsStorage.dequeue_scraper_job" title="Permalink to this definition"></a></dt>
<dd><p>Try to dequeue pending scraper job of given priority</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>priority</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><em>ScraperJobPriority</em></a>) – Queue priority</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>First pending scraper job or None if the queue is empty</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScraperJobsStorage.get_queue_len">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_queue_len</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><span class="pre">sneakpeek.lib.models.ScraperJobPriority</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScraperJobsStorage.get_queue_len" title="Permalink to this definition"></a></dt>
<dd><p>Get number of pending scraper jobs in the queue</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>priority</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><em>ScraperJobPriority</em></a>) – Queue priority</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of pending scraper jobs in the queue</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScraperJobsStorage.get_scraper_job">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_scraper_job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scraper_job_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScraperJobsStorage.get_scraper_job" title="Permalink to this definition"></a></dt>
<dd><p>Get scraper job by ID.
Throws <a class="reference internal" href="#sneakpeek.lib.errors.ScraperNotFoundError" title="sneakpeek.lib.errors.ScraperNotFoundError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScraperNotFoundError</span></code></a> if scraper doesn’t exist
Throws <a class="reference internal" href="#sneakpeek.lib.errors.ScraperJobNotFoundError" title="sneakpeek.lib.errors.ScraperJobNotFoundError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScraperJobNotFoundError</span></code></a> if scraper job doesn’t exist</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scraper_id</strong> (<em>int</em>) – Scraper ID</p></li>
<li><p><strong>scraper_job_id</strong> (<em>int</em>) – scraper job ID</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Found scraper job</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScraperJobsStorage.get_scraper_jobs">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_scraper_jobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScraperJobsStorage.get_scraper_jobs" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper_id</strong> (<em>int</em>) – Scraper ID</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of scraper jobs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScraperJobsStorage.update_scraper_job">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">update_scraper_job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper_job</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScraperJobsStorage.update_scraper_job" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper_job</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><em>ScraperJob</em></a>) – scraper job to update</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Updated scraper job</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScrapersStorage">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.storage.base.</span></span><span class="sig-name descname"><span class="pre">ScrapersStorage</span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScrapersStorage" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Sneakpeeker storage scraper storage abstract class</p>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScrapersStorage.create_scraper">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">create_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScrapersStorage.create_scraper" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper</strong> (<a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><em>Scraper</em></a>) – Scraper Metadata</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Created scraper</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScrapersStorage.delete_scraper">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">delete_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScrapersStorage.delete_scraper" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>id</strong> (<em>int</em>) – Scraper ID</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Deleted scraper</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScrapersStorage.get_scraper">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScrapersStorage.get_scraper" title="Permalink to this definition"></a></dt>
<dd><p>Get scraper by ID. Throws <a class="reference internal" href="#sneakpeek.lib.errors.ScraperNotFoundError" title="sneakpeek.lib.errors.ScraperNotFoundError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScraperNotFoundError</span></code></a> if scraper doesn’t exist</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>id</strong> (<em>int</em>) – Scraper ID</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Scraper metadata</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScrapersStorage.get_scrapers">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_scrapers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScrapersStorage.get_scrapers" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of all available scrapers</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>List[<a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScrapersStorage.is_read_only">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">is_read_only</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScrapersStorage.is_read_only" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether the storage allows modifiying scrapers list and metadata</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScrapersStorage.maybe_get_scraper">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">maybe_get_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScrapersStorage.maybe_get_scraper" title="Permalink to this definition"></a></dt>
<dd><p>Get scraper by ID. Return None if scraper doesn’t exist</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>id</strong> (<em>int</em>) – Scraper ID</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Scraper metadata</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScrapersStorage.search_scrapers">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">search_scrapers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_filter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_items</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScrapersStorage.search_scrapers" title="Permalink to this definition"></a></dt>
<dd><p>Search scrapers using given filters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_filter</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Search scrapers that have given substring in the name. Defaults to None.</p></li>
<li><p><strong>max_items</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Maximum number of items to return. Defaults to None.</p></li>
<li><p><strong>offset</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Offset for search results. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Found scrapers</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.base.ScrapersStorage.update_scraper">
<em class="property"><span class="pre">abstract</span> <span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">update_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.base.ScrapersStorage.update_scraper" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper</strong> (<a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><em>Scraper</em></a>) – Scraper Metadata</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Updated scraper</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-sneakpeek.lib.storage.in_memory_storage"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryLeaseStorage">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.storage.in_memory_storage.</span></span><span class="sig-name descname"><span class="pre">InMemoryLeaseStorage</span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryLeaseStorage" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sneakpeek.lib.storage.base.LeaseStorage" title="sneakpeek.lib.storage.base.LeaseStorage"><code class="xref py py-class docutils literal notranslate"><span class="pre">sneakpeek.lib.storage.base.LeaseStorage</span></code></a></p>
<p>In memory storage for leases. Should only be used for development purposes</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryLeaseStorage.maybe_acquire_lease">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">maybe_acquire_lease</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lease_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">owner_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acquire_for</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">datetime.timedelta</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Lease" title="sneakpeek.lib.models.Lease"><span class="pre">sneakpeek.lib.models.Lease</span></a> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryLeaseStorage.maybe_acquire_lease" title="Permalink to this definition"></a></dt>
<dd><p>Try to acquire lease (global lock).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lease_name</strong> (<em>str</em>) – Lease name (resource name to be locked)</p></li>
<li><p><strong>owner_id</strong> (<em>str</em>) – ID of the acquirer (should be the same if you already have the lease and want to prolong it)</p></li>
<li><p><strong>acquire_for</strong> (<em>timedelta</em>) – For how long lease will be acquired</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Lease metadata if it was acquired, None otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Lease" title="sneakpeek.lib.models.Lease">Lease</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryLeaseStorage.release_lease">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">release_lease</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lease_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">owner_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryLeaseStorage.release_lease" title="Permalink to this definition"></a></dt>
<dd><p>Release lease (global lock)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lease_name</strong> (<em>str</em>) – Lease name (resource name to be unlocked)</p></li>
<li><p><strong>owner_id</strong> (<em>str</em>) – ID of the acquirer</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.storage.in_memory_storage.</span></span><span class="sig-name descname"><span class="pre">InMemoryScraperJobsStorage</span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sneakpeek.lib.storage.base.ScraperJobsStorage" title="sneakpeek.lib.storage.base.ScraperJobsStorage"><code class="xref py py-class docutils literal notranslate"><span class="pre">sneakpeek.lib.storage.base.ScraperJobsStorage</span></code></a></p>
<p>In memory storage for scraper jobs. Should only be used for development purposes</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage.add_scraper_job">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">add_scraper_job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper_job</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage.add_scraper_job" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper_job</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><em>ScraperJob</em></a>) – scraper job to add</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Created scraper job</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage.delete_old_scraper_jobs">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">delete_old_scraper_jobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_last</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage.delete_old_scraper_jobs" title="Permalink to this definition"></a></dt>
<dd><p>Delete old historical scraper jobs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>keep_last</strong> (<em>int</em><em>, </em><em>optional</em>) – How many historical scraper jobs to keep. Defaults to 50.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage.dequeue_scraper_job">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">dequeue_scraper_job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><span class="pre">sneakpeek.lib.models.ScraperJobPriority</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage.dequeue_scraper_job" title="Permalink to this definition"></a></dt>
<dd><p>Try to dequeue pending scraper job of given priority</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>priority</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><em>ScraperJobPriority</em></a>) – Queue priority</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>First pending scraper job or None if the queue is empty</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage.get_queue_len">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_queue_len</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><span class="pre">sneakpeek.lib.models.ScraperJobPriority</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage.get_queue_len" title="Permalink to this definition"></a></dt>
<dd><p>Get number of pending scraper jobs in the queue</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>priority</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><em>ScraperJobPriority</em></a>) – Queue priority</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of pending scraper jobs in the queue</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage.get_scraper_job">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_scraper_job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scraper_job_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage.get_scraper_job" title="Permalink to this definition"></a></dt>
<dd><p>Get scraper job by ID.
Throws <a class="reference internal" href="#sneakpeek.lib.errors.ScraperNotFoundError" title="sneakpeek.lib.errors.ScraperNotFoundError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScraperNotFoundError</span></code></a> if scraper doesn’t exist
Throws <a class="reference internal" href="#sneakpeek.lib.errors.ScraperJobNotFoundError" title="sneakpeek.lib.errors.ScraperJobNotFoundError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScraperJobNotFoundError</span></code></a> if scraper job doesn’t exist</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scraper_id</strong> (<em>int</em>) – Scraper ID</p></li>
<li><p><strong>scraper_job_id</strong> (<em>int</em>) – scraper job ID</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Found scraper job</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage.get_scraper_jobs">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_scraper_jobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage.get_scraper_jobs" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scraper_id</strong> (<em>int</em>) – Scraper ID</p></li>
<li><p><strong>id</strong> (<em>int</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of scraper jobs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage.update_scraper_job">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">update_scraper_job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper_job</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScraperJobsStorage.update_scraper_job" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper_job</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><em>ScraperJob</em></a>) – scraper job to update</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Updated scraper job</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.storage.in_memory_storage.</span></span><span class="sig-name descname"><span class="pre">InMemoryScrapersStorage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scrapers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_read_only</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sneakpeek.lib.storage.base.ScrapersStorage" title="sneakpeek.lib.storage.base.ScrapersStorage"><code class="xref py py-class docutils literal notranslate"><span class="pre">sneakpeek.lib.storage.base.ScrapersStorage</span></code></a></p>
<p>In-memory storage implementation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scrapers</strong> (<em>list</em><em>[</em><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><em>Scraper</em></a><em>] </em><em>| </em><em>None</em><em>, </em><em>optional</em>) – List of pre-defined scrapers. Defaults to None.</p></li>
<li><p><strong>is_read_only</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to allow modifications of the scrapers list. Set to true only for development. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.create_scraper">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">create_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.create_scraper" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper</strong> (<a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><em>Scraper</em></a>) – Scraper Metadata</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Created scraper</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.delete_scraper">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">delete_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.delete_scraper" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>id</strong> (<em>int</em>) – Scraper ID</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Deleted scraper</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.get_scraper">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.get_scraper" title="Permalink to this definition"></a></dt>
<dd><p>Get scraper by ID. Throws <a class="reference internal" href="#sneakpeek.lib.errors.ScraperNotFoundError" title="sneakpeek.lib.errors.ScraperNotFoundError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScraperNotFoundError</span></code></a> if scraper doesn’t exist</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>id</strong> (<em>int</em>) – Scraper ID</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Scraper metadata</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.get_scrapers">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_scrapers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.get_scrapers" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of all available scrapers</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>List[<a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.is_read_only">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">is_read_only</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.is_read_only" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether the storage allows modifiying scrapers list and metadata</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.maybe_get_scraper">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">maybe_get_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.maybe_get_scraper" title="Permalink to this definition"></a></dt>
<dd><p>Get scraper by ID. Return None if scraper doesn’t exist</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>id</strong> (<em>int</em>) – Scraper ID</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Scraper metadata</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.search_scrapers">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">search_scrapers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_filter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_items</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.search_scrapers" title="Permalink to this definition"></a></dt>
<dd><p>Search scrapers using given filters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_filter</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Search scrapers that have given substring in the name. Defaults to None.</p></li>
<li><p><strong>max_items</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Maximum number of items to return. Defaults to None.</p></li>
<li><p><strong>offset</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Offset for search results. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Found scrapers</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.update_scraper">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">update_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.in_memory_storage.InMemoryScrapersStorage.update_scraper" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper</strong> (<a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><em>Scraper</em></a>) – Scraper Metadata</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Updated scraper</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-sneakpeek.lib.storage.redis_storage"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisLeaseStorage">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.storage.redis_storage.</span></span><span class="sig-name descname"><span class="pre">RedisLeaseStorage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">redis</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">redis.asyncio.client.Redis</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisLeaseStorage" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sneakpeek.lib.storage.base.LeaseStorage" title="sneakpeek.lib.storage.base.LeaseStorage"><code class="xref py py-class docutils literal notranslate"><span class="pre">sneakpeek.lib.storage.base.LeaseStorage</span></code></a></p>
<p>Redis storage for leases. Should only be used for development purposes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>redis</strong> (<em>Redis</em>) – Async redis client</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisLeaseStorage.maybe_acquire_lease">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">maybe_acquire_lease</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lease_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">owner_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acquire_for</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">datetime.timedelta</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Lease" title="sneakpeek.lib.models.Lease"><span class="pre">sneakpeek.lib.models.Lease</span></a> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisLeaseStorage.maybe_acquire_lease" title="Permalink to this definition"></a></dt>
<dd><p>Try to acquire lease (global lock).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lease_name</strong> (<em>str</em>) – Lease name (resource name to be locked)</p></li>
<li><p><strong>owner_id</strong> (<em>str</em>) – ID of the acquirer (should be the same if you already have the lease and want to prolong it)</p></li>
<li><p><strong>acquire_for</strong> (<em>timedelta</em>) – For how long lease will be acquired</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Lease metadata if it was acquired, None otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Lease" title="sneakpeek.lib.models.Lease">Lease</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisLeaseStorage.release_lease">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">release_lease</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lease_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">owner_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisLeaseStorage.release_lease" title="Permalink to this definition"></a></dt>
<dd><p>Release lease (global lock)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lease_name</strong> (<em>str</em>) – Lease name (resource name to be unlocked)</p></li>
<li><p><strong>owner_id</strong> (<em>str</em>) – ID of the acquirer</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.storage.redis_storage.</span></span><span class="sig-name descname"><span class="pre">RedisScraperJobsStorage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">redis</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">redis.asyncio.client.Redis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scrapers_storage</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.storage.base.ScrapersStorage" title="sneakpeek.lib.storage.base.ScrapersStorage"><span class="pre">sneakpeek.lib.storage.base.ScrapersStorage</span></a></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sneakpeek.lib.storage.base.ScraperJobsStorage" title="sneakpeek.lib.storage.base.ScraperJobsStorage"><code class="xref py py-class docutils literal notranslate"><span class="pre">sneakpeek.lib.storage.base.ScraperJobsStorage</span></code></a></p>
<p>Redis storage for scraper jobs. Should only be used for development purposes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>redis</strong> (<em>Redis</em>) – Async redis client</p></li>
<li><p><strong>scrapers_storage</strong> (<a class="reference internal" href="#sneakpeek.lib.storage.base.ScrapersStorage" title="sneakpeek.lib.storage.base.ScrapersStorage"><em>sneakpeek.lib.storage.base.ScrapersStorage</em></a>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage.add_scraper_job">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">add_scraper_job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper_job</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage.add_scraper_job" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper_job</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><em>ScraperJob</em></a>) – scraper job to add</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Created scraper job</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage.delete_old_scraper_jobs">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">delete_old_scraper_jobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keep_last</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">50</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage.delete_old_scraper_jobs" title="Permalink to this definition"></a></dt>
<dd><p>Delete old historical scraper jobs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>keep_last</strong> (<em>int</em><em>, </em><em>optional</em>) – How many historical scraper jobs to keep. Defaults to 50.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage.dequeue_scraper_job">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">dequeue_scraper_job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><span class="pre">sneakpeek.lib.models.ScraperJobPriority</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage.dequeue_scraper_job" title="Permalink to this definition"></a></dt>
<dd><p>Try to dequeue pending scraper job of given priority</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>priority</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><em>ScraperJobPriority</em></a>) – Queue priority</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>First pending scraper job or None if the queue is empty</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a> | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage.get_queue_len">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_queue_len</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><span class="pre">sneakpeek.lib.models.ScraperJobPriority</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage.get_queue_len" title="Permalink to this definition"></a></dt>
<dd><p>Get number of pending scraper jobs in the queue</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>priority</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJobPriority" title="sneakpeek.lib.models.ScraperJobPriority"><em>ScraperJobPriority</em></a>) – Queue priority</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of pending scraper jobs in the queue</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage.get_scraper_job">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_scraper_job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scraper_job_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage.get_scraper_job" title="Permalink to this definition"></a></dt>
<dd><p>Get scraper job by ID.
Throws <a class="reference internal" href="#sneakpeek.lib.errors.ScraperNotFoundError" title="sneakpeek.lib.errors.ScraperNotFoundError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScraperNotFoundError</span></code></a> if scraper doesn’t exist
Throws <a class="reference internal" href="#sneakpeek.lib.errors.ScraperJobNotFoundError" title="sneakpeek.lib.errors.ScraperJobNotFoundError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScraperJobNotFoundError</span></code></a> if scraper job doesn’t exist</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scraper_id</strong> (<em>int</em>) – Scraper ID</p></li>
<li><p><strong>scraper_job_id</strong> (<em>int</em>) – scraper job ID</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Found scraper job</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage.get_scraper_jobs">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_scraper_jobs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage.get_scraper_jobs" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper_id</strong> (<em>int</em>) – Scraper ID</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of scraper jobs</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage.update_scraper_job">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">update_scraper_job</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper_job</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><span class="pre">sneakpeek.lib.models.ScraperJob</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScraperJobsStorage.update_scraper_job" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper_job</strong> (<a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob"><em>ScraperJob</em></a>) – scraper job to update</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Updated scraper job</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.ScraperJob" title="sneakpeek.lib.models.ScraperJob">ScraperJob</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScrapersStorage">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.lib.storage.redis_storage.</span></span><span class="sig-name descname"><span class="pre">RedisScrapersStorage</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">redis</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">redis.asyncio.client.Redis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_read_only</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScrapersStorage" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sneakpeek.lib.storage.base.ScrapersStorage" title="sneakpeek.lib.storage.base.ScrapersStorage"><code class="xref py py-class docutils literal notranslate"><span class="pre">sneakpeek.lib.storage.base.ScrapersStorage</span></code></a></p>
<p>Redis scrapers storage implementation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>redis</strong> (<em>Redis</em>) – Async redis client</p></li>
<li><p><strong>is_read_only</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to allow modifications of the scrapers list. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.create_scraper">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">create_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.create_scraper" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper</strong> (<a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><em>Scraper</em></a>) – Scraper Metadata</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Created scraper</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.delete_scraper">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">delete_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.delete_scraper" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>id</strong> (<em>int</em>) – Scraper ID</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Deleted scraper</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.get_scraper">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.get_scraper" title="Permalink to this definition"></a></dt>
<dd><p>Get scraper by ID. Throws <a class="reference internal" href="#sneakpeek.lib.errors.ScraperNotFoundError" title="sneakpeek.lib.errors.ScraperNotFoundError"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScraperNotFoundError</span></code></a> if scraper doesn’t exist</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>id</strong> (<em>int</em>) – Scraper ID</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Scraper metadata</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.get_scrapers">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">get_scrapers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.get_scrapers" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>List of all available scrapers</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>List[<a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.is_read_only">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">is_read_only</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.is_read_only" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether the storage allows modifiying scrapers list and metadata</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.maybe_get_scraper">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">maybe_get_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.maybe_get_scraper" title="Permalink to this definition"></a></dt>
<dd><p>Get scraper by ID. Return None if scraper doesn’t exist</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>id</strong> (<em>int</em>) – Scraper ID</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Scraper metadata</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.search_scrapers">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">search_scrapers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name_filter</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_items</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.search_scrapers" title="Permalink to this definition"></a></dt>
<dd><p>Search scrapers using given filters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name_filter</strong> (<em>str</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Search scrapers that have given substring in the name. Defaults to None.</p></li>
<li><p><strong>max_items</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Maximum number of items to return. Defaults to None.</p></li>
<li><p><strong>offset</strong> (<em>int</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Offset for search results. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Found scrapers</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[<a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.update_scraper">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">update_scraper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scraper</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><span class="pre">sneakpeek.lib.models.Scraper</span></a></span></span><a class="headerlink" href="#sneakpeek.lib.storage.redis_storage.RedisScrapersStorage.update_scraper" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scraper</strong> (<a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper"><em>Scraper</em></a>) – Scraper Metadata</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Updated scraper</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.lib.models.Scraper" title="sneakpeek.lib.models.Scraper">Scraper</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-sneakpeek.plugins.proxy_plugin"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.plugins.proxy_plugin.ProxyPlugin">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.plugins.proxy_plugin.</span></span><span class="sig-name descname"><span class="pre">ProxyPlugin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.plugins.proxy_plugin.ProxyPluginConfig" title="sneakpeek.plugins.proxy_plugin.ProxyPluginConfig"><span class="pre">sneakpeek.plugins.proxy_plugin.ProxyPluginConfig</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.plugins.proxy_plugin.ProxyPlugin" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sneakpeek.scraper_context.BeforeRequestPlugin" title="sneakpeek.scraper_context.BeforeRequestPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">sneakpeek.scraper_context.BeforeRequestPlugin</span></code></a></p>
<p>Proxy plugin automatically sets proxy arguments for all HTTP requests.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>default_config</strong> (<a class="reference internal" href="#sneakpeek.plugins.proxy_plugin.ProxyPluginConfig" title="sneakpeek.plugins.proxy_plugin.ProxyPluginConfig"><em>sneakpeek.plugins.proxy_plugin.ProxyPluginConfig</em></a><em> | </em><em>None</em>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.plugins.proxy_plugin.ProxyPlugin.before_request">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">before_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><span class="pre">sneakpeek.scraper_context.Request</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><span class="pre">sneakpeek.scraper_context.Request</span></a></span></span><a class="headerlink" href="#sneakpeek.plugins.proxy_plugin.ProxyPlugin.before_request" title="Permalink to this definition"></a></dt>
<dd><p>Function that is called on each (HTTP) request before its dispatched.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> (<a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><em>Request</em></a>) – Request metadata</p></li>
<li><p><strong>config</strong> (<em>Any</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Plugin configuration. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Request metadata</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request">Request</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sneakpeek.plugins.proxy_plugin.ProxyPlugin.name">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#sneakpeek.plugins.proxy_plugin.ProxyPlugin.name" title="Permalink to this definition"></a></dt>
<dd><p>Name of the plugin</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.plugins.proxy_plugin.ProxyPluginConfig">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.plugins.proxy_plugin.</span></span><span class="sig-name descname"><span class="pre">ProxyPluginConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span> <span class="p"><span class="pre">|</span></span> <span class="pre">yarl.URL</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proxy_auth</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">aiohttp.helpers.BasicAuth</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.plugins.proxy_plugin.ProxyPluginConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<p>Proxy plugin config</p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises ValidationError if the input data cannot be parsed to form a valid model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>proxy</strong> (<em>str</em><em> | </em><em>yarl.URL</em><em> | </em><em>None</em>) – </p></li>
<li><p><strong>proxy_auth</strong> (<em>aiohttp.helpers.BasicAuth</em><em> | </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.plugins.proxy_plugin.ProxyPluginConfig.proxy">
<span class="sig-name descname"><span class="pre">proxy</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span> <span class="p"><span class="pre">|</span></span> <span class="pre">yarl.URL</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></em><a class="headerlink" href="#sneakpeek.plugins.proxy_plugin.ProxyPluginConfig.proxy" title="Permalink to this definition"></a></dt>
<dd><p>Proxy URL</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.plugins.proxy_plugin.ProxyPluginConfig.proxy_auth">
<span class="sig-name descname"><span class="pre">proxy_auth</span></span><em class="property"><span class="pre">:</span> <span class="pre">aiohttp.helpers.BasicAuth</span> <span class="p"><span class="pre">|</span></span> <span class="pre">None</span></em><a class="headerlink" href="#sneakpeek.plugins.proxy_plugin.ProxyPluginConfig.proxy_auth" title="Permalink to this definition"></a></dt>
<dd><p>Proxy authentication info to use</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-sneakpeek.plugins.rate_limiter_plugin"></span><dl class="py exception">
<dt class="sig sig-object py" id="sneakpeek.plugins.rate_limiter_plugin.RateLimitedException">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.plugins.rate_limiter_plugin.</span></span><span class="sig-name descname"><span class="pre">RateLimitedException</span></span><a class="headerlink" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimitedException" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Request is rate limited because too many requests were made to the host</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.plugins.rate_limiter_plugin.RateLimitedStrategy">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.plugins.rate_limiter_plugin.</span></span><span class="sig-name descname"><span class="pre">RateLimitedStrategy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimitedStrategy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>What to do if the request is rate limited</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.plugins.rate_limiter_plugin.RateLimitedStrategy.THROW">
<span class="sig-name descname"><span class="pre">THROW</span></span><em class="property"> <span class="pre">=</span> <span class="pre">1</span></em><a class="headerlink" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimitedStrategy.THROW" title="Permalink to this definition"></a></dt>
<dd><p>Throw an exception</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.plugins.rate_limiter_plugin.RateLimitedStrategy.WAIT">
<span class="sig-name descname"><span class="pre">WAIT</span></span><em class="property"> <span class="pre">=</span> <span class="pre">2</span></em><a class="headerlink" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimitedStrategy.WAIT" title="Permalink to this definition"></a></dt>
<dd><p>Wait until request is no longer rate limited</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.plugins.rate_limiter_plugin.RateLimiterPlugin">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.plugins.rate_limiter_plugin.</span></span><span class="sig-name descname"><span class="pre">RateLimiterPlugin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimiterPluginConfig" title="sneakpeek.plugins.rate_limiter_plugin.RateLimiterPluginConfig"><span class="pre">sneakpeek.plugins.rate_limiter_plugin.RateLimiterPluginConfig</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimiterPlugin" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sneakpeek.scraper_context.BeforeRequestPlugin" title="sneakpeek.scraper_context.BeforeRequestPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">sneakpeek.scraper_context.BeforeRequestPlugin</span></code></a></p>
<p>Rate limiter implements <a class="reference external" href="https://en.wikipedia.org/wiki/Leaky_bucket">leaky bucket algorithm</a>
to limit number of requests made to the hosts. If the request is rate limited it can either
raise an exception or wait until the request won’t be limited anymore.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>default_config</strong> (<a class="reference internal" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimiterPluginConfig" title="sneakpeek.plugins.rate_limiter_plugin.RateLimiterPluginConfig"><em>sneakpeek.plugins.rate_limiter_plugin.RateLimiterPluginConfig</em></a><em> | </em><em>None</em>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.plugins.rate_limiter_plugin.RateLimiterPlugin.before_request">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">before_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><span class="pre">sneakpeek.scraper_context.Request</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><span class="pre">sneakpeek.scraper_context.Request</span></a></span></span><a class="headerlink" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimiterPlugin.before_request" title="Permalink to this definition"></a></dt>
<dd><p>Function that is called on each (HTTP) request before its dispatched.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> (<a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><em>Request</em></a>) – Request metadata</p></li>
<li><p><strong>config</strong> (<em>Any</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Plugin configuration. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Request metadata</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request">Request</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sneakpeek.plugins.rate_limiter_plugin.RateLimiterPlugin.name">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimiterPlugin.name" title="Permalink to this definition"></a></dt>
<dd><p>Name of the plugin</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.plugins.rate_limiter_plugin.RateLimiterPluginConfig">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.plugins.rate_limiter_plugin.</span></span><span class="sig-name descname"><span class="pre">RateLimiterPluginConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_requests</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">60</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate_limited_strategy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimitedStrategy" title="sneakpeek.plugins.rate_limiter_plugin.RateLimitedStrategy"><span class="pre">sneakpeek.plugins.rate_limiter_plugin.RateLimitedStrategy</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">RateLimitedStrategy.WAIT</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_window</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">datetime.timedelta</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">datetime.timedelta(seconds=60)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimiterPluginConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<p>Rate limiter plugin configuration</p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises ValidationError if the input data cannot be parsed to form a valid model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_requests</strong> (<em>int</em>) – </p></li>
<li><p><strong>rate_limited_strategy</strong> (<a class="reference internal" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimitedStrategy" title="sneakpeek.plugins.rate_limiter_plugin.RateLimitedStrategy"><em>sneakpeek.plugins.rate_limiter_plugin.RateLimitedStrategy</em></a>) – </p></li>
<li><p><strong>time_window</strong> (<em>datetime.timedelta</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.plugins.rate_limiter_plugin.RateLimiterPluginConfig.max_requests">
<span class="sig-name descname"><span class="pre">max_requests</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimiterPluginConfig.max_requests" title="Permalink to this definition"></a></dt>
<dd><p>Maximum number of allowed requests per host within time window</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.plugins.rate_limiter_plugin.RateLimiterPluginConfig.rate_limited_strategy">
<span class="sig-name descname"><span class="pre">rate_limited_strategy</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimitedStrategy" title="sneakpeek.plugins.rate_limiter_plugin.RateLimitedStrategy"><span class="pre">sneakpeek.plugins.rate_limiter_plugin.RateLimitedStrategy</span></a></em><a class="headerlink" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimiterPluginConfig.rate_limited_strategy" title="Permalink to this definition"></a></dt>
<dd><p>What to do if the request is rate limited</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.plugins.rate_limiter_plugin.RateLimiterPluginConfig.time_window">
<span class="sig-name descname"><span class="pre">time_window</span></span><em class="property"><span class="pre">:</span> <span class="pre">datetime.timedelta</span></em><a class="headerlink" href="#sneakpeek.plugins.rate_limiter_plugin.RateLimiterPluginConfig.time_window" title="Permalink to this definition"></a></dt>
<dd><p>Time window to aggregate requests</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-sneakpeek.plugins.requests_logging_plugin"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPlugin">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.plugins.requests_logging_plugin.</span></span><span class="sig-name descname"><span class="pre">RequestsLoggingPlugin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPluginConfig" title="sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPluginConfig"><span class="pre">sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPluginConfig</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPlugin" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sneakpeek.scraper_context.BeforeRequestPlugin" title="sneakpeek.scraper_context.BeforeRequestPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">sneakpeek.scraper_context.BeforeRequestPlugin</span></code></a>, <a class="reference internal" href="#sneakpeek.scraper_context.AfterResponsePlugin" title="sneakpeek.scraper_context.AfterResponsePlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">sneakpeek.scraper_context.AfterResponsePlugin</span></code></a></p>
<p>Requests logging middleware logs all requests being made and received responses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>default_config</strong> (<a class="reference internal" href="#sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPluginConfig" title="sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPluginConfig"><em>sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPluginConfig</em></a><em> | </em><em>None</em>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPlugin.after_response">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">after_response</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><span class="pre">sneakpeek.scraper_context.Request</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">response</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">aiohttp.client_reqrep.ClientResponse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">aiohttp.client_reqrep.ClientResponse</span></span></span><a class="headerlink" href="#sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPlugin.after_response" title="Permalink to this definition"></a></dt>
<dd><p>Function that is called on each (HTTP) response before its result returned to the caller.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> (<a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><em>Request</em></a>) – Request metadata</p></li>
<li><p><strong>response</strong> (<em>aiohttp.ClientResponse</em>) – HTTP Response</p></li>
<li><p><strong>config</strong> (<em>Any</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Plugin configuration. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HTTP Response</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>aiohttp.ClientResponse</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPlugin.before_request">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">before_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><span class="pre">sneakpeek.scraper_context.Request</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><span class="pre">sneakpeek.scraper_context.Request</span></a></span></span><a class="headerlink" href="#sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPlugin.before_request" title="Permalink to this definition"></a></dt>
<dd><p>Function that is called on each (HTTP) request before its dispatched.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> (<a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><em>Request</em></a>) – Request metadata</p></li>
<li><p><strong>config</strong> (<em>Any</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Plugin configuration. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Request metadata</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request">Request</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPlugin.name">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPlugin.name" title="Permalink to this definition"></a></dt>
<dd><p>Name of the plugin</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPluginConfig">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.plugins.requests_logging_plugin.</span></span><span class="sig-name descname"><span class="pre">RequestsLoggingPluginConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_response</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPluginConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<p>Requests logging plugin config</p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises ValidationError if the input data cannot be parsed to form a valid model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_request</strong> (<em>bool</em>) – </p></li>
<li><p><strong>log_response</strong> (<em>bool</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPluginConfig.log_request">
<span class="sig-name descname"><span class="pre">log_request</span></span><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPluginConfig.log_request" title="Permalink to this definition"></a></dt>
<dd><p>Whether to log request being made</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPluginConfig.log_response">
<span class="sig-name descname"><span class="pre">log_response</span></span><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#sneakpeek.plugins.requests_logging_plugin.RequestsLoggingPluginConfig.log_response" title="Permalink to this definition"></a></dt>
<dd><p>Whether to log response being made</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-sneakpeek.plugins.robots_txt_plugin"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.plugins.robots_txt_plugin.RobotsTxtPlugin">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.plugins.robots_txt_plugin.</span></span><span class="sig-name descname"><span class="pre">RobotsTxtPlugin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.plugins.robots_txt_plugin.RobotsTxtPluginConfig" title="sneakpeek.plugins.robots_txt_plugin.RobotsTxtPluginConfig"><span class="pre">sneakpeek.plugins.robots_txt_plugin.RobotsTxtPluginConfig</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.plugins.robots_txt_plugin.RobotsTxtPlugin" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sneakpeek.scraper_context.BeforeRequestPlugin" title="sneakpeek.scraper_context.BeforeRequestPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">sneakpeek.scraper_context.BeforeRequestPlugin</span></code></a></p>
<p>Robots.txt plugin can log and optionally block requests if they are disallowed by website robots.txt.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>default_config</strong> (<a class="reference internal" href="#sneakpeek.plugins.robots_txt_plugin.RobotsTxtPluginConfig" title="sneakpeek.plugins.robots_txt_plugin.RobotsTxtPluginConfig"><em>sneakpeek.plugins.robots_txt_plugin.RobotsTxtPluginConfig</em></a><em> | </em><em>None</em>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.plugins.robots_txt_plugin.RobotsTxtPlugin.before_request">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">before_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><span class="pre">sneakpeek.scraper_context.Request</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><span class="pre">sneakpeek.scraper_context.Request</span></a></span></span><a class="headerlink" href="#sneakpeek.plugins.robots_txt_plugin.RobotsTxtPlugin.before_request" title="Permalink to this definition"></a></dt>
<dd><p>Function that is called on each (HTTP) request before its dispatched.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> (<a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><em>Request</em></a>) – Request metadata</p></li>
<li><p><strong>config</strong> (<em>Any</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Plugin configuration. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Request metadata</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request">Request</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sneakpeek.plugins.robots_txt_plugin.RobotsTxtPlugin.name">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#sneakpeek.plugins.robots_txt_plugin.RobotsTxtPlugin.name" title="Permalink to this definition"></a></dt>
<dd><p>Name of the plugin</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.plugins.robots_txt_plugin.RobotsTxtPluginConfig">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.plugins.robots_txt_plugin.</span></span><span class="sig-name descname"><span class="pre">RobotsTxtPluginConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">violation_strategy</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.plugins.robots_txt_plugin.RobotsTxtViolationStrategy" title="sneakpeek.plugins.robots_txt_plugin.RobotsTxtViolationStrategy"><span class="pre">sneakpeek.plugins.robots_txt_plugin.RobotsTxtViolationStrategy</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">RobotsTxtViolationStrategy.LOG</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.plugins.robots_txt_plugin.RobotsTxtPluginConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<p>robots.txt plugin configuration</p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises ValidationError if the input data cannot be parsed to form a valid model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>violation_strategy</strong> (<a class="reference internal" href="#sneakpeek.plugins.robots_txt_plugin.RobotsTxtViolationStrategy" title="sneakpeek.plugins.robots_txt_plugin.RobotsTxtViolationStrategy"><em>sneakpeek.plugins.robots_txt_plugin.RobotsTxtViolationStrategy</em></a>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="sneakpeek.plugins.robots_txt_plugin.RobotsTxtViolationException">
<em class="property"><span class="pre">exception</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.plugins.robots_txt_plugin.</span></span><span class="sig-name descname"><span class="pre">RobotsTxtViolationException</span></span><a class="headerlink" href="#sneakpeek.plugins.robots_txt_plugin.RobotsTxtViolationException" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Exception which is raised if request is disallowed by website robots.txt</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.plugins.robots_txt_plugin.RobotsTxtViolationStrategy">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.plugins.robots_txt_plugin.</span></span><span class="sig-name descname"><span class="pre">RobotsTxtViolationStrategy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.plugins.robots_txt_plugin.RobotsTxtViolationStrategy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>What to do if the request is disallowed by website robots.txt</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.plugins.robots_txt_plugin.RobotsTxtViolationStrategy.LOG">
<span class="sig-name descname"><span class="pre">LOG</span></span><em class="property"> <span class="pre">=</span> <span class="pre">1</span></em><a class="headerlink" href="#sneakpeek.plugins.robots_txt_plugin.RobotsTxtViolationStrategy.LOG" title="Permalink to this definition"></a></dt>
<dd><p>Only log violation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.plugins.robots_txt_plugin.RobotsTxtViolationStrategy.THROW">
<span class="sig-name descname"><span class="pre">THROW</span></span><em class="property"> <span class="pre">=</span> <span class="pre">2</span></em><a class="headerlink" href="#sneakpeek.plugins.robots_txt_plugin.RobotsTxtViolationStrategy.THROW" title="Permalink to this definition"></a></dt>
<dd><p>Raise an exception on vioalation</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-sneakpeek.plugins.user_agent_injecter_plugin"></span><dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPlugin">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.plugins.user_agent_injecter_plugin.</span></span><span class="sig-name descname"><span class="pre">UserAgentInjecterPlugin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">default_config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPluginConfig" title="sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPluginConfig"><span class="pre">sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPluginConfig</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPlugin" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#sneakpeek.scraper_context.BeforeRequestPlugin" title="sneakpeek.scraper_context.BeforeRequestPlugin"><code class="xref py py-class docutils literal notranslate"><span class="pre">sneakpeek.scraper_context.BeforeRequestPlugin</span></code></a></p>
<p>This plugin automatically adds <code class="docutils literal notranslate"><span class="pre">User-Agent</span></code> header if it’s not present.
It uses <a class="reference external" href="https://pypi.org/project/fake-useragent/">fake-useragent</a> in order to generate fake real world user agents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>default_config</strong> (<a class="reference internal" href="#sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPluginConfig" title="sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPluginConfig"><em>sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPluginConfig</em></a><em> | </em><em>None</em>) – </p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPlugin.before_request">
<em class="property"><span class="pre">async</span> </em><span class="sig-name descname"><span class="pre">before_request</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><span class="pre">sneakpeek.scraper_context.Request</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><span class="pre">sneakpeek.scraper_context.Request</span></a></span></span><a class="headerlink" href="#sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPlugin.before_request" title="Permalink to this definition"></a></dt>
<dd><p>Function that is called on each (HTTP) request before its dispatched.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request</strong> (<a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request"><em>Request</em></a>) – Request metadata</p></li>
<li><p><strong>config</strong> (<em>Any</em><em> | </em><em>None</em><em>, </em><em>optional</em>) – Plugin configuration. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Request metadata</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#sneakpeek.scraper_context.Request" title="sneakpeek.scraper_context.Request">Request</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPlugin.name">
<em class="property"><span class="pre">property</span> </em><span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><a class="headerlink" href="#sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPlugin.name" title="Permalink to this definition"></a></dt>
<dd><p>Name of the plugin</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPluginConfig">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">sneakpeek.plugins.user_agent_injecter_plugin.</span></span><span class="sig-name descname"><span class="pre">UserAgentInjecterPluginConfig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_external_data</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">browsers</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">['chrome',</span> <span class="pre">'edge',</span> <span class="pre">'firefox',</span> <span class="pre">'safari',</span> <span class="pre">'opera']</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPluginConfig" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pydantic.main.BaseModel</span></code></p>
<p>Plugin configuration</p>
<p>Create a new model by parsing and validating input data from keyword arguments.</p>
<p>Raises ValidationError if the input data cannot be parsed to form a valid model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>use_external_data</strong> (<em>bool</em>) – </p></li>
<li><p><strong>browsers</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPluginConfig.browsers">
<span class="sig-name descname"><span class="pre">browsers</span></span><em class="property"><span class="pre">:</span> <span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPluginConfig.browsers" title="Permalink to this definition"></a></dt>
<dd><p>List of browsers which are used to generate user agents</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPluginConfig.use_external_data">
<span class="sig-name descname"><span class="pre">use_external_data</span></span><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#sneakpeek.plugins.user_agent_injecter_plugin.UserAgentInjecterPluginConfig.use_external_data" title="Permalink to this definition"></a></dt>
<dd><p>Whether to use external data as a fallback</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-sneakpeek.plugins.utils"></span></section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plugins/new_plugin.html" class="btn btn-neutral float-left" title="Adding your own plugin" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Dan Yazovsky.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
    <!-- Theme Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3EW8JNTBHC"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-3EW8JNTBHC', {
          'anonymize_ip': false,
      });
    </script> 

</body>
</html>